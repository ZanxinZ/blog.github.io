---
title: "N4000 四网口工控机组网"
date: 2023-05-13T22:43:27+08:00
ShowToc: true
categories: 
- 工具
tags: 
- WRT 路由器
---

### 需要用到的硬件

- 工控机本体这里称为 A，
- 一台可以连接 WiFi 或者可插入以太网网线的设备称为 B。
- 公网的接入端口线称为 C。
- 一个 Wifi 路由器D。
- 键盘与HDMI 显示器（用于命令行查看系统信息，可省略）、两条网线。

### 方法一：”不同网段“接法

软路由的 LAN 接 WiFi 的 WAN，连接 WiFi 的设备和直连软路由的设备不算是同一网段。

![Untitled](../N4000%20%E5%9B%9B%E7%BD%91%E5%8F%A3%E5%B7%A5%E6%8E%A7%E6%9C%BA%E7%BB%84%E7%BD%91/Untitled.png)

WiFi 所在 192.168.1.x 

软路由所在 192.168.11.x 

**关键步骤：**

- 以太网连接，从 C 上接一条网线到 A 的 eth1 端口。D 的 WAN 网口和 A 的 eth0 用网线连接。
- 使用设备 B，连接 WiFi，然后登入后台管理页面，网址一般在 WiFi 路由器背后有写明。

设备B 需要关键一步：设置为 自动 IP 分配，那么才可以在 B 上访问到 192.168.11.1

关键配置：

登入D 的 后台页面（依据不同品牌而定，我这里是 192.168.1.1）。WiFi 路由器 D 的设置，需要设置为 自动获得 IP 地址，拔掉 WiFi 的电源，重启，它会通过A、公网 C 自动获得 IP。这时，连接到该 WiFi 的设备就可以通过 192.168.11.1 进入软路由的管理页面了。

![Untitled](../N4000%20%E5%9B%9B%E7%BD%91%E5%8F%A3%E5%B7%A5%E6%8E%A7%E6%9C%BA%E7%BB%84%E7%BD%91/Untitled%201.png)

进入 软路由系统的管理页面，在 openclash 中填入订阅地址，保存设置然后启动 clash 服务，即可。

![Untitled](../N4000%20%E5%9B%9B%E7%BD%91%E5%8F%A3%E5%B7%A5%E6%8E%A7%E6%9C%BA%E7%BB%84%E7%BD%91/Untitled%202.png)

### 方法二：同一网段的接法

软路由与 WiFi 之间使用 LAN，连接 WiFi 的设备和直连软路由的设备属于同一网段。

![Untitled](../N4000%20%E5%9B%9B%E7%BD%91%E5%8F%A3%E5%B7%A5%E6%8E%A7%E6%9C%BA%E7%BB%84%E7%BD%91/Untitled%203.png)

**修改为交换机模式 AP mode**

设置本 WiFi 配置页面的 IP 地址，网段和软路由那边的保持一致。

![Untitled](../N4000%20%E5%9B%9B%E7%BD%91%E5%8F%A3%E5%B7%A5%E6%8E%A7%E6%9C%BA%E7%BB%84%E7%BD%91/Untitled%204.png)

关闭 DHCP，使得路由器不作为子网网关

![Untitled](../N4000%20%E5%9B%9B%E7%BD%91%E5%8F%A3%E5%B7%A5%E6%8E%A7%E6%9C%BA%E7%BB%84%E7%BD%91/Untitled%205.png)

这样一来，连接到 WiFi 的设备既可以访问 192.168.11.1 的软路由管理页面，也可以访问原本 WiFi 的管理页面。后续的 open clash 配置和方法一的一样。

### 实际运行效果：两台播放 1080P 视频的设备同时使用，CPU 占用率也不高，可以看出来这个 N4000 在日常个人多设备使用场景下基本是够用的

![Untitled](../N4000%20%E5%9B%9B%E7%BD%91%E5%8F%A3%E5%B7%A5%E6%8E%A7%E6%9C%BA%E7%BB%84%E7%BD%91/Untitled%206.png)