<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Closures | CodePaper</title>
<meta name=keywords content="编程语言"><meta name=description content="The closures can cantains something by the curly bracket."><meta name=author content><link rel=canonical href=https://wowios.com/post/language/swift/07closures/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://wowios.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wowios.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wowios.com/favicon-32x32.png><link rel=apple-touch-icon href=https://wowios.com/apple-touch-icon.png><link rel=mask-icon href=https://wowios.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://wowios.com/post/language/swift/07closures/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://wowios.com/post/language/swift/07closures/"><meta property="og:site_name" content="CodePaper"><meta property="og:title" content="Closures"><meta property="og:description" content="The closures can cantains something by the curly bracket."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-04-02T16:10:40+08:00"><meta property="article:modified_time" content="2022-04-02T16:10:40+08:00"><meta property="article:tag" content="编程语言"><meta name=twitter:card content="summary"><meta name=twitter:title content="Closures"><meta name=twitter:description content="The closures can cantains something by the curly bracket."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"语言","item":"https://wowios.com/language/"},{"@type":"ListItem","position":2,"name":"Closures","item":"https://wowios.com/post/language/swift/07closures/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Closures","name":"Closures","description":"The closures can cantains something by the curly bracket.","keywords":["编程语言"],"articleBody":"Closures **are self-contained blocks of functionality that can be passed around and used in your code.\nGlobal and nested functions are special cases of closures.\nGlobal functions are closures that have name and don’t capture any value. Nested functions are closures that have a name and can capture values from the enclosing function. Closure expressions are unnamed closures written in a lightweight syntax that can capture values from their surrounding context. The sort() will sort at original array, and sorted() will sort and return a new sorted array.\nUsage Pass a closure to a function as a tool to do something.\nFor example, pass as a comparator to a sorted function.\nPass multiple closure to a function as some handler to deal the different circumstances after the function call.\nFor example, pass a completion and onFailure closure to a loadPicture function, and to do reaction for the picture load complete or fail.\nClosures’ Syntax {(parameters) -\u003e return type in statements, the closure's body } Pass a function closure to a function, as a tool to do some work.\nfunc compare(_ s1: String, _ s2: String) -\u003e Bool{ return s1 \u003e s2 } let names = [\"Chris\", \"Alex\", \"Ewa\", \"Barry\", \"Daniella\"] var sortedNames = names.sorted(by: compare) // Here we pass a comparator to the sorted method. // Here the sortedNames is [\"Ewa\", \"Daniella\", \"Chris\", \"Barry\", \"Alex\"] An easy way to pass a function (or say a comparator) to a sorted method.\nThis is the inline closure.\nlet names = [\"Chris\", \"Alex\", \"Ewa\", \"Barry\", \"Daniella\"] var sortedNames = names.sorted({(_ s1: String, _ s2: String) -\u003e Bool in return s1 \u003e s2 }) Inferring Type From Context\nlet names = [\"Chris\", \"Alex\", \"Ewa\", \"Barry\", \"Daniella\"] var sortedNames = names.sorted(by: { s1, s2 in return s1 \u003e s2 } ) // The compiler will infer the parameter types and the return value type. Implicit Return in Single-Expression Closures\nlet names = [\"Chris\", \"Alex\", \"Ewa\", \"Barry\", \"Daniella\"] var sortedNames = names.sorted(by: { s1, s2 in s1 \u003e s2 } ) Shorthand Argument Names for Inline Closures\nlet names = [\"Chris\", \"Alex\", \"Ewa\", \"Barry\", \"Daniella\"] var sortedNames = names.sorted(by: { $0 \u003e $1 }) // '$0' means that getting the first parameter to do the comparation.. Operator Methods\nString type has its string-specific implementation of the grater than operator ‘\u003e’ can be a method that has two parameters of type String, and return a value of type Bool. let names = [\"Chris\", \"Alex\", \"Ewa\", \"Barry\", \"Daniella\"] var sortedNames = names.sorted(by: \u003e) Trailing Closures Without Trailing Closures\nfunc someFunction(closure: () -\u003e void) { } someFunction(closure: { // closure's body, to do something. }) var sortedNames = names.sorted(by: {$0 \u003e$1}) With Trailing Closures\nsomeFunction() { // Trailing closure's body} var sortedNames = names.sorted() {$0 \u003e $1} With Trailing Closures Omitting Parentheses\nvar sortedNames = names.sorted {$0 \u003e $1} Apply a Provided Closure to Each Element of A Map Using the map() method, and give a closure to it. (The map method here omit the parentheses)\nThe closure say that input a Int , output a String , the process of the closure is after the in .\nlet digitNames = [ 0: \"Zero\", 1: \"One\", 2: \"Two\", 3: \"Three\", 4: \"Four\", 5: \"Five\", 6: \"Six\", 7: \"Seven\", 8: \"Eight\", 9: \"Nine\" ] // A dictionary. let numbers = [16, 58, 510] // The type of number can be omitted, because it can be inferred from the value the map to be mapped. let numbersStr = numbers.map { (number: Int) -\u003e String in var num = number // The 'number' parameter can't be modified, so we set a 'num' to use its value. var str: String = \"\" repeat { str = digitNames[num % 10]! + str // remainder operate to get the num's last digit. num /= 10 } while num \u003e 0 return str } // Now the numbersStr is [\"OneSix\", \"FiveEight\",\"FiveOneZero\"] In the above, digitNames[num % 10]! use the exclamation point, because the result from digitNames is optional, it may be not found by num%10 .(The exclamation point is used to force-unwrap the String value)\nFunction Use Multiple Closures func loadPicture(from server: Server, completion: (Picture) -\u003e Void, onFailure: () -\u003e Void) { if let picture = download(\"photo.jpg\", from: server) { completion(picture) } else { onFailure() } } When we call the loadPicture function, we should give it a completion and an onFailure closure as two handlers, so that after the network service done the work, with the handler, we can do something when the download complete or fail.\nCapturing Values A closure can capture constants and variables from the surrounding context in which it’s define. It can read those constants and modify those variables, even if the original scope no longer exist.\nNested function is a form of closure that can capture values from it outside scope.\nfunc run(count: Int) -\u003e () -\u003e Int{ var a = 5 func wait() -\u003e Int { // The function 'wait' capture the reference of 'a' and 'count' from the surrounding function. a += count return a } func go() -\u003e Int { a += count * 2 return a } return wait // It returns a function, not a simple value. } print(run(count: 4)()) // Print: 9 // Capturing by reference ensures that 'a' and 'count' don’t disappear when the call to 'run' ends, and also ensures that 'a' is available the next time the 'wait' function is called. // If the value isn't mutated by a closure, Swift may store a copy of this value instead of capture it. let fun = run(count: 10) print(fun()) print(fun()) Result\n9 15 25\nThe first time use the run(count: 4) , it has a scope for run.\nThe second time use the run(count: 10), it has another scope.\nNOTE If you assign a closure to a property of a class instance, and the closure captures that instance by referring to the instance or its members, you will create a strong reference cycle between the closure and the instance. Swift uses capture lists to break these strong reference cycles.\nClosures Are Reference Types let fun = run(count: 10) print(fun()) print(fun()) let myFun = fun print(myFun()) Result\n15 25 35\nEscaping Closures In order to let the closure to be use in the function caller’s scope, or the closure want to use the content in the function caller’s scope, we should specify the closure parameter with @escaping , otherwise it will cause the compile-time error.\nThe escaping indicate that the closure is store in a value that’s defined outside the function.\nvar handlers: [() -\u003e Void] = [] func addHandle(handle: @escaping () -\u003e Void) { handlers.append(handle) let han: () -\u003e Void han = handle // The handle must be specified with @escaping func run() { } addHandle(handle: run) The code follow is not allow, because the handle has’t been defined(create instance) before the addHandle return.\nfunc addHandle(handle: () -\u003e Void) -\u003e () -\u003e Void { return handle // The closure 'handle' can't be use } Add the @escaping to solve the problem above. It will escape(store in a value outside the function) and then call the reference.\nfunc addHandle(handle: @escaping () -\u003e Void) -\u003e () -\u003e Void { return handle } Capturing self Capturing self in an escaping closure makes it easy to accidentally create a strong reference cycle.\nWhen we want to use the properties in current instance of the class, must use self explicitly, or include self in the closure’s capture list.\nUse self Explicitly\nclass Person { var age = 23 func printAge(){ self.age = 24 print(self.age) } func printAgeOther(age: Int){ print(self.age)} // Here the self is needed certainly. Otherwise we can't derferentiate the 'age' of the instance and current function. } var person = Person() person.printAgeOther(age: 4) Include the self in Capture List\nfunc doSomething(_ fun: () -\u003e Void){ fun() } class Person { var age = 23 func printAgeOther(){ [self] // The capture list. age = 22 print(age) // Here is use the 'self.age' } func myFunc() { doSomething(){ [self] in print(age) // Here is use the 'self.age' } } } var person = Person() person.printAgeOther() person.myFunc() Result\n22 22\nCapture self in structure or enumeration\nCan always refer to self implicitly. But an escaping closure can’t capture a mutable reference to self . func doSomething(_ fun: () -\u003e Void){ fun() } func doSomethingElse(_ fun: @escaping () -\u003e Void){ fun() } struct Person { var age = 23 mutating func myFunc(){ doSomething(){ age = 18 print(age) } // The follow code, 'doSomethingElse' function's parameter is escaping, it will trigger compiler error. // doSomethingElse(){ // age = 17 // print(age) // } } } var person = Person() person.myFunc() Autoclosures When the closure is assigned to a var or a let , it hasn’t been call, just give its function reference to other.\nIt can be use as delays evaluation or overtime judge.\nvar names = [\"Mike\", \"Alice\", \"Jhon\"] print(names.count) let theRemover = { names.remove(at: 0)} // Get the closure's reference. print(names.count) print(\"Remove element: \\(theRemover())\") // Call the closure, run the closure's body first time. print(names.count) Result\n3 3 Remove element: Mike 2\ntheRemover has a type () -\u003e String\nAlso, we can write it in function like below.\nvar names = [\"Mike\", \"Alice\", \"Jhon\"] print(names.count) func doSomething(action: () -\u003e String){ print(\"Remove elsemet: \\(action())\") } doSomething(action: {names.remove(at: 0)}) print(names.count) Use the @autoclosure , it has the same result as the code above.\nvar names = [\"Mike\", \"Alice\", \"Jhon\"] print(names.count) func doSomething(action: @autoclosure () -\u003e String){ print(\"Remove elsemet: \\(action())\") } doSomething(action: names.remove(at: 0)) print(names.count) Use the @autoclosure and @escaping .\nvar names = [\"Mike\", \"Alice\", \"Jhon\"] print(names.count) var funs: [() -\u003e String] = [] func doSomething(action: @autoclosure @escaping () -\u003e String){ print(\"Remove elsemet: \\(action())\") funs.append(action) // It need the condition that action is escaping.(maybe because the action is a reference?)) name.append(\"Jane\") // The \"Jane\" can be added to name. } doSomething(action: names.remove(at: 0)) print(names.count) The escaping means that the argument action is allowed to escape the function’s scope.\n","wordCount":"1658","inLanguage":"en","datePublished":"2022-04-02T16:10:40+08:00","dateModified":"2022-04-02T16:10:40+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://wowios.com/post/language/swift/07closures/"},"publisher":{"@type":"Organization","name":"CodePaper","logo":{"@type":"ImageObject","url":"https://wowios.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wowios.com/ accesskey=h title="CodePaper (Alt + H)">CodePaper</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wowios.com/archive/ title=📦档案><span>📦档案</span></a></li><li><a href=https://wowios.com/categories/ title=📖类别><span>📖类别</span></a></li><li><a href=https://wowios.com/tags/ title=🏷️标签><span>🏷️标签</span></a></li><li><a href=https://wowios.com/search/ title="🔎搜索 (Alt + /)" accesskey=/><span>🔎搜索</span></a></li><li><a href=https://wowios.com/about/ title=🧑‍💻关于我><span>🧑‍💻关于我</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wowios.com/>Home</a>&nbsp;»&nbsp;<a href=https://wowios.com/language/>语言</a></div><h1 class="post-title entry-hint-parent">Closures</h1><div class=post-meta><span title='2022-04-02 16:10:40 +0800 CST'>April 2, 2022</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><ul><li><a href=#usage aria-label=Usage>Usage</a></li></ul><li><a href=#closures-syntax aria-label="Closures’ Syntax">Closures’ Syntax</a></li><li><a href=#trailing-closures aria-label="Trailing Closures">Trailing Closures</a><ul><li><a href=#apply-a-provided-closure-to-each-element-of-a-map aria-label="Apply a Provided Closure to Each Element of A Map">Apply a Provided Closure to Each Element of A Map</a></li><li><a href=#function-use-multiple-closures aria-label="Function Use Multiple Closures">Function Use Multiple Closures</a></li></ul></li><li><a href=#capturing-values aria-label="Capturing Values">Capturing Values</a></li><li><a href=#closures-are-reference-types aria-label="Closures Are Reference Types">Closures Are Reference Types</a></li><li><a href=#escaping-closures aria-label="Escaping Closures">Escaping Closures</a><ul><li><a href=#capturing-self aria-label="Capturing self">Capturing self</a></li></ul></li><li><a href=#autoclosures aria-label=Autoclosures>Autoclosures</a></li></ul></div></details></div><div class=post-content><p>Closures **are self-contained blocks of functionality that can be passed around and used in your code.</p><p>Global and nested functions are special cases of closures.</p><ul><li>Global functions are closures that have name and don’t capture any value.</li><li>Nested functions are closures that have a name and can capture values from the enclosing function.</li><li>Closure expressions are unnamed closures written in a lightweight syntax that can capture values from their surrounding context.</li></ul><p>The <code>sort()</code> will sort at original array, and <code>sorted()</code> will sort and return a new sorted array.</p><h3 id=usage>Usage<a hidden class=anchor aria-hidden=true href=#usage>#</a></h3><ul><li><p>Pass a closure to a function as a tool to do something.</p><p>For example, pass as a comparator to a sorted function.</p></li><li><p>Pass multiple closure to a function as some handler to deal the different circumstances after the function call.</p><p>For example, pass a <code>completion</code> and <code>onFailure</code> closure to a <code>loadPicture</code> function, and to do reaction for the picture load complete or fail.</p></li></ul><hr><h2 id=closures-syntax>Closures’ Syntax<a hidden class=anchor aria-hidden=true href=#closures-syntax>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>{(parameters) -&gt; 
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> type <span style=color:#66d9ef>in</span> 
</span></span><span style=display:flex><span>		statements, the closure<span style=color:#960050;background-color:#1e0010>&#39;</span>s body
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Pass a function closure to a function, as a tool to do some work.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>compare</span>(<span style=color:#66d9ef>_</span> s1: String, <span style=color:#66d9ef>_</span> s2: String) -&gt; Bool{
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> s1 <span style=color:#f92672>&gt;</span> s2
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> names = [<span style=color:#e6db74>&#34;Chris&#34;</span>, <span style=color:#e6db74>&#34;Alex&#34;</span>, <span style=color:#e6db74>&#34;Ewa&#34;</span>, <span style=color:#e6db74>&#34;Barry&#34;</span>, <span style=color:#e6db74>&#34;Daniella&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted(by: compare)  <span style=color:#75715e>// Here we pass a comparator to the sorted method.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Here the sortedNames is [&#34;Ewa&#34;, &#34;Daniella&#34;, &#34;Chris&#34;, &#34;Barry&#34;, &#34;Alex&#34;]</span>
</span></span></code></pre></div><p>An easy way to pass a function (or say a comparator) to a sorted method.</p><p>This is the <strong>inline closure</strong>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> names = [<span style=color:#e6db74>&#34;Chris&#34;</span>, <span style=color:#e6db74>&#34;Alex&#34;</span>, <span style=color:#e6db74>&#34;Ewa&#34;</span>, <span style=color:#e6db74>&#34;Barry&#34;</span>, <span style=color:#e6db74>&#34;Daniella&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted({(<span style=color:#66d9ef>_</span> s1: String, <span style=color:#66d9ef>_</span> s2: String) -&gt; 
</span></span><span style=display:flex><span>		Bool <span style=color:#66d9ef>in</span> 
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> s1 <span style=color:#f92672>&gt;</span> s2
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>Inferring Type From Context</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> names = [<span style=color:#e6db74>&#34;Chris&#34;</span>, <span style=color:#e6db74>&#34;Alex&#34;</span>, <span style=color:#e6db74>&#34;Ewa&#34;</span>, <span style=color:#e6db74>&#34;Barry&#34;</span>, <span style=color:#e6db74>&#34;Daniella&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted(by: { s1, s2 <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>return</span> s1 <span style=color:#f92672>&gt;</span> s2 } )
</span></span><span style=display:flex><span><span style=color:#75715e>// The compiler will infer the parameter types and the return value type.</span>
</span></span></code></pre></div><p>Implicit Return in Single-Expression Closures</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> names = [<span style=color:#e6db74>&#34;Chris&#34;</span>, <span style=color:#e6db74>&#34;Alex&#34;</span>, <span style=color:#e6db74>&#34;Ewa&#34;</span>, <span style=color:#e6db74>&#34;Barry&#34;</span>, <span style=color:#e6db74>&#34;Daniella&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted(by: { s1, s2 <span style=color:#66d9ef>in</span> s1 <span style=color:#f92672>&gt;</span> s2 } )
</span></span></code></pre></div><p>Shorthand Argument Names for Inline Closures</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> names = [<span style=color:#e6db74>&#34;Chris&#34;</span>, <span style=color:#e6db74>&#34;Alex&#34;</span>, <span style=color:#e6db74>&#34;Ewa&#34;</span>, <span style=color:#e6db74>&#34;Barry&#34;</span>, <span style=color:#e6db74>&#34;Daniella&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted(by: { $0 <span style=color:#f92672>&gt;</span> $1 })  <span style=color:#75715e>// &#39;$0&#39; means that getting the first parameter to do the comparation..</span>
</span></span></code></pre></div><p>Operator Methods</p><ul><li><code>String</code> type has its string-specific implementation of the grater than operator ‘>’ can be a method that has two parameters of type <code>String</code>, and return a value of type <code>Bool</code>.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> names = [<span style=color:#e6db74>&#34;Chris&#34;</span>, <span style=color:#e6db74>&#34;Alex&#34;</span>, <span style=color:#e6db74>&#34;Ewa&#34;</span>, <span style=color:#e6db74>&#34;Barry&#34;</span>, <span style=color:#e6db74>&#34;Daniella&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted(by: <span style=color:#f92672>&gt;</span>)
</span></span></code></pre></div><h2 id=trailing-closures>Trailing Closures<a hidden class=anchor aria-hidden=true href=#trailing-closures>#</a></h2><p>Without Trailing Closures</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>someFunction</span>(closure: () -&gt; void) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>someFunction(closure: {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// closure&#39;s body, to do something.</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted(by: {$0 <span style=color:#f92672>&gt;</span>$1})
</span></span></code></pre></div><p>With Trailing Closures</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>someFunction() { <span style=color:#75715e>// Trailing closure&#39;s body}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted() {$0 <span style=color:#f92672>&gt;</span> $1}
</span></span></code></pre></div><p>With Trailing Closures Omitting Parentheses</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>var</span> sortedNames = names.sorted {$0 <span style=color:#f92672>&gt;</span> $1}
</span></span></code></pre></div><h3 id=apply-a-provided-closure-to-each-element-of-a-map>Apply a Provided Closure to Each Element of A Map<a hidden class=anchor aria-hidden=true href=#apply-a-provided-closure-to-each-element-of-a-map>#</a></h3><p>Using the map() method, and give a closure to it. (The map method here omit the parentheses)</p><p>The closure say that input a <code>Int</code> , output a <code>String</code> , the process of the closure is after the <code>in</code> .</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> digitNames = [
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span>: <span style=color:#e6db74>&#34;Zero&#34;</span>, <span style=color:#ae81ff>1</span>: <span style=color:#e6db74>&#34;One&#34;</span>, <span style=color:#ae81ff>2</span>: <span style=color:#e6db74>&#34;Two&#34;</span>,   <span style=color:#ae81ff>3</span>: <span style=color:#e6db74>&#34;Three&#34;</span>, <span style=color:#ae81ff>4</span>: <span style=color:#e6db74>&#34;Four&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>5</span>: <span style=color:#e6db74>&#34;Five&#34;</span>, <span style=color:#ae81ff>6</span>: <span style=color:#e6db74>&#34;Six&#34;</span>, <span style=color:#ae81ff>7</span>: <span style=color:#e6db74>&#34;Seven&#34;</span>, <span style=color:#ae81ff>8</span>: <span style=color:#e6db74>&#34;Eight&#34;</span>, <span style=color:#ae81ff>9</span>: <span style=color:#e6db74>&#34;Nine&#34;</span>
</span></span><span style=display:flex><span>]  <span style=color:#75715e>// A dictionary.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> numbers = [<span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>510</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// The type of number can be omitted, because it can be inferred from the value the map to be mapped.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> numbersStr = numbers.map { (number: Int) -&gt; String <span style=color:#66d9ef>in</span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> num = number <span style=color:#75715e>// The &#39;number&#39; parameter can&#39;t be modified, so we set a &#39;num&#39; to use its value.</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> str: String = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>repeat</span> {
</span></span><span style=display:flex><span>        str = digitNames[num <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span>]<span style=color:#f92672>!</span> <span style=color:#f92672>+</span> str <span style=color:#75715e>// remainder operate to get the num&#39;s last digit.</span>
</span></span><span style=display:flex><span>        num <span style=color:#f92672>/=</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>while</span> num <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> str
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// Now the numbersStr is [&#34;OneSix&#34;, &#34;FiveEight&#34;,&#34;FiveOneZero&#34;]</span>
</span></span></code></pre></div><p>In the above, <code>digitNames[num % 10]!</code> use the exclamation point, because the result from <code>digitNames</code> is optional, it may be not found by <code>num%10</code> .(The exclamation point is used to force-unwrap the <code>String</code> value)</p><h3 id=function-use-multiple-closures>Function Use Multiple Closures<a hidden class=anchor aria-hidden=true href=#function-use-multiple-closures>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>loadPicture</span>(from server: Server, completion: (Picture) -&gt; Void, onFailure: () -&gt; Void) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> picture = download(<span style=color:#e6db74>&#34;photo.jpg&#34;</span>, from: server) {
</span></span><span style=display:flex><span>				completion(picture)
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>				onFailure()
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>When we call the <code>loadPicture</code> function, we should give it a <code>completion</code> and an <code>onFailure</code> closure as two handlers, so that after the network service done the work, with the handler, we can do something when the download complete or fail.</p><h2 id=capturing-values>Capturing Values<a hidden class=anchor aria-hidden=true href=#capturing-values>#</a></h2><p>A closure can capture constants and variables from the surrounding context in which it’s define. It can <strong>read</strong> those constants and <strong>modify</strong> those variables, even if the original scope no longer exist.</p><ul><li><p>Nested function is a form of closure that can capture values from it outside scope.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>run</span>(count: Int) -&gt; () -&gt; Int{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> a = <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>wait</span>() -&gt; Int {
</span></span><span style=display:flex><span>				<span style=color:#75715e>// The function &#39;wait&#39; capture the reference of &#39;a&#39; and &#39;count&#39; from the surrounding function.</span>
</span></span><span style=display:flex><span>        a <span style=color:#f92672>+=</span> count
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>go</span>() -&gt; Int {
</span></span><span style=display:flex><span>				a <span style=color:#f92672>+=</span> count <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>return</span> a
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>  wait <span style=color:#75715e>// It returns a function, not a simple value.</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(run(count: <span style=color:#ae81ff>4</span>)())
</span></span><span style=display:flex><span><span style=color:#75715e>// Print: 9</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Capturing by reference ensures that &#39;a&#39; and &#39;count&#39; don’t disappear when the call to &#39;run&#39; ends, and also ensures that &#39;a&#39; is available the next time the &#39;wait&#39; function is called.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// If the value isn&#39;t mutated by a closure, Swift may store a copy of this value instead of capture it.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> fun = run(count: <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>print(fun())
</span></span><span style=display:flex><span>print(fun())
</span></span></code></pre></div><p>Result</p><p>9
15
25</p><p>The first time use the <code>run(count: 4)</code> , it has a scope for run.</p><p>The second time use the <code>run(count: 10)</code>, it has another scope.</p><blockquote><p>NOTE
If you assign a closure to a property of a class instance, and the closure captures that instance by referring to the instance or its members, you will create a strong reference cycle between the closure and the instance. Swift uses <em>capture lists</em>
 to break these strong reference cycles.</p></blockquote></li></ul><h2 id=closures-are-reference-types>Closures Are Reference Types<a hidden class=anchor aria-hidden=true href=#closures-are-reference-types>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> fun = run(count: <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>print(fun())
</span></span><span style=display:flex><span>print(fun())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> myFun = fun
</span></span><span style=display:flex><span>print(myFun())
</span></span></code></pre></div><p>Result</p><p>15
25
35</p><h2 id=escaping-closures>Escaping Closures<a hidden class=anchor aria-hidden=true href=#escaping-closures>#</a></h2><p>In order to let the closure to be use in the function caller’s scope, or the closure want to use the content in the function caller’s scope, we should specify the closure parameter with <code>@escaping</code> , otherwise it will cause the compile-time error.</p><p>The escaping indicate that the closure is store in a value that’s defined outside the function.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>var</span> handlers: [() -&gt; Void] = []
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>addHandle</span>(handle: @escaping () -&gt; Void) {
</span></span><span style=display:flex><span>    handlers.append(handle)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>let</span> han: () -&gt; Void
</span></span><span style=display:flex><span>		han = handle  <span style=color:#75715e>// The handle must be specified with @escaping</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>run</span>() {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>addHandle(handle: run)
</span></span></code></pre></div><p>The code follow is <strong>not allow</strong>, because the handle has’t been defined(create instance) before the addHandle return.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>addHandle</span>(handle: () -&gt; Void) -&gt; () -&gt; Void {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> handle <span style=color:#75715e>// The closure &#39;handle&#39; can&#39;t be use</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Add the <code>@escaping</code> to solve the problem above. It will escape(store in a value outside the function) and then call the reference.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>addHandle</span>(handle: @escaping () -&gt; Void) -&gt; () -&gt; Void {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> handle
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=capturing-self>Capturing <code>self</code><a hidden class=anchor aria-hidden=true href=#capturing-self>#</a></h3><p>Capturing <code>self</code> in an escaping closure makes it easy to accidentally create a strong reference cycle.</p><p>When we want to use the properties in current instance of the class, must <strong>use <code>self</code> explicitly,</strong> or include <code>self</code> in the <strong>closure’s capture list</strong>.</p><p>Use <code>self</code> Explicitly</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> age = <span style=color:#ae81ff>23</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>printAge</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.age = <span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span>        print(<span style=color:#66d9ef>self</span>.age)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>printAgeOther</span>(age: Int){
</span></span><span style=display:flex><span>        print(<span style=color:#66d9ef>self</span>.age)}  <span style=color:#75715e>// Here the self is needed certainly. Otherwise we can&#39;t derferentiate the &#39;age&#39; of the instance and current function.</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> person = Person()
</span></span><span style=display:flex><span>person.printAgeOther(age: <span style=color:#ae81ff>4</span>)
</span></span></code></pre></div><p>Include the <code>self</code> in Capture List</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomething</span>(<span style=color:#66d9ef>_</span> fun: () -&gt; Void){
</span></span><span style=display:flex><span>    fun()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> age = <span style=color:#ae81ff>23</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>printAgeOther</span>(){ 
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>self</span>]          <span style=color:#75715e>// The capture list.</span>
</span></span><span style=display:flex><span>        age = <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>        print(age)      <span style=color:#75715e>// Here is use the &#39;self.age&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>myFunc</span>() {
</span></span><span style=display:flex><span>        doSomething(){
</span></span><span style=display:flex><span>            [<span style=color:#66d9ef>self</span>] <span style=color:#66d9ef>in</span> 
</span></span><span style=display:flex><span>            print(age) <span style=color:#75715e>// Here is use the &#39;self.age&#39;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> person = Person()
</span></span><span style=display:flex><span>person.printAgeOther()
</span></span><span style=display:flex><span>person.myFunc()
</span></span></code></pre></div><ul><li><p>Result</p><p>22
22</p><p>Capture <code>self</code> in <code>structure</code> or <code>enumeration</code></p><ul><li>Can always refer to <code>self</code> implicitly.</li><li>But an escaping closure can’t capture a mutable reference to <code>self</code> .</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomething</span>(<span style=color:#66d9ef>_</span> fun: () -&gt; Void){
</span></span><span style=display:flex><span>    fun()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomethingElse</span>(<span style=color:#66d9ef>_</span> fun: @escaping () -&gt; Void){
</span></span><span style=display:flex><span>    fun()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Person</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> age = <span style=color:#ae81ff>23</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>mutating</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>myFunc</span>(){
</span></span><span style=display:flex><span>        doSomething(){
</span></span><span style=display:flex><span>            age = <span style=color:#ae81ff>18</span>
</span></span><span style=display:flex><span>            print(age)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// The follow code, &#39;doSomethingElse&#39; function&#39;s parameter is escaping, it will trigger compiler error.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//        doSomethingElse(){</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//            age = 17</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//            print(age)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//        }</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> person = Person()
</span></span><span style=display:flex><span>person.myFunc()
</span></span></code></pre></div><h2 id=autoclosures>Autoclosures<a hidden class=anchor aria-hidden=true href=#autoclosures>#</a></h2><p>When the closure is assigned to a <code>var</code> or a <code>let</code> , it hasn’t been call, just give its function reference to other.</p><p>It can be use as delays evaluation or overtime judge.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>var</span> names = [<span style=color:#e6db74>&#34;Mike&#34;</span>, <span style=color:#e6db74>&#34;Alice&#34;</span>, <span style=color:#e6db74>&#34;Jhon&#34;</span>]
</span></span><span style=display:flex><span>print(names.count)
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> theRemover = { names.remove(at: <span style=color:#ae81ff>0</span>)}   <span style=color:#75715e>// Get the closure&#39;s reference.</span>
</span></span><span style=display:flex><span>print(names.count)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Remove element: </span><span style=color:#e6db74>\(</span>theRemover<span style=color:#e6db74>())</span><span style=color:#e6db74>&#34;</span>)  <span style=color:#75715e>// Call the closure, run the closure&#39;s body first time.</span>
</span></span><span style=display:flex><span>print(names.count)
</span></span></code></pre></div><ul><li><p>Result</p><p>3
3
Remove element: Mike
2</p><p><code>theRemover</code> has a type <code>() -> String</code></p></li></ul><p>Also, we can write it in function like below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>var</span> names = [<span style=color:#e6db74>&#34;Mike&#34;</span>, <span style=color:#e6db74>&#34;Alice&#34;</span>, <span style=color:#e6db74>&#34;Jhon&#34;</span>]
</span></span><span style=display:flex><span>print(names.count)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomething</span>(action: () -&gt; String){
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Remove elsemet: </span><span style=color:#e6db74>\(</span>action<span style=color:#e6db74>())</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>doSomething(action: {names.remove(at: <span style=color:#ae81ff>0</span>)})
</span></span><span style=display:flex><span>print(names.count)
</span></span></code></pre></div><p>Use the <code>@autoclosure</code> , it has the same result as the code above.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>var</span> names = [<span style=color:#e6db74>&#34;Mike&#34;</span>, <span style=color:#e6db74>&#34;Alice&#34;</span>, <span style=color:#e6db74>&#34;Jhon&#34;</span>]
</span></span><span style=display:flex><span>print(names.count)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomething</span>(action: <span style=color:#66d9ef>@autoclosure</span> () -&gt; String){
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Remove elsemet: </span><span style=color:#e6db74>\(</span>action<span style=color:#e6db74>())</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>doSomething(action: names.remove(at: <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>print(names.count)
</span></span></code></pre></div><p>Use the <code>@autoclosure</code> and <code>@escaping</code> .</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>var</span> names = [<span style=color:#e6db74>&#34;Mike&#34;</span>, <span style=color:#e6db74>&#34;Alice&#34;</span>, <span style=color:#e6db74>&#34;Jhon&#34;</span>]
</span></span><span style=display:flex><span>print(names.count)
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> funs: [() -&gt; String] = []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomething</span>(action: <span style=color:#66d9ef>@autoclosure</span> @escaping () -&gt; String){
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Remove elsemet: </span><span style=color:#e6db74>\(</span>action<span style=color:#e6db74>())</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    funs.append(action)  <span style=color:#75715e>// It need the condition that action is escaping.(maybe because the action is a reference?))</span>
</span></span><span style=display:flex><span>		name.append(<span style=color:#e6db74>&#34;Jane&#34;</span>)  <span style=color:#75715e>// The &#34;Jane&#34; can be added to name.</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>doSomething(action: names.remove(at: <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>print(names.count)
</span></span></code></pre></div><p>The escaping means that the argument <code>action</code> is allowed to escape the function’s scope.</p></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://wowios.com/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/>编程语言</a></li></ul><nav class=paginav><a class=prev href=https://wowios.com/post/language/swift/12subscripts/><span class=title>« Prev</span><br><span>Subscripts</span>
</a><a class=next href=https://wowios.com/post/language/swift/06function/><span class=title>Next »</span><br><span>Function</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Closures on x" href="https://x.com/intent/tweet/?text=Closures&amp;url=https%3a%2f%2fwowios.com%2fpost%2flanguage%2fswift%2f07closures%2f&amp;hashtags=%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Closures on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwowios.com%2fpost%2flanguage%2fswift%2f07closures%2f&title=Closures"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Closures on telegram" href="https://telegram.me/share/url?text=Closures&amp;url=https%3a%2f%2fwowios.com%2fpost%2flanguage%2fswift%2f07closures%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://wowios.com/>CodePaper</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>