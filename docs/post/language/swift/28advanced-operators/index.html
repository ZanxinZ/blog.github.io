<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Advanced Operators | CodePaper</title>
<meta name=keywords content="编程语言">
<meta name=description content="Unlike arithmetic operators in C, arithmetic operators in Swift don’t overflow by default. If want to overflow by default, use the overflow operation begin with ampersand (&). For example, the overflow addition operator (&+).
It’s so free to define custom infix, prefix, postfix and assignment operators, precedence and associativity values.
Bitwise Operators Here we use a function to pad 0 for the number’s print result.
func pad(num: UInt8, count: Int) -> String { var str = String(num, radix: 2) var res: String = str for _ in 0.">
<meta name=author content>
<link rel=canonical href=https://1-1.link/post/language/swift/28advanced-operators/>
<link crossorigin=anonymous href=/assets/css/stylesheet.ea5f2fd568f688f106fb918bfebdccb965b2f6ecb642824b56e5e0a12f25311c.css integrity="sha256-6l8v1Wj2iPEG+5GL/r3MuWWy9uy2QoJLVuXgoS8lMRw=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://1-1.link/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://1-1.link/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://1-1.link/favicon-32x32.png>
<link rel=apple-touch-icon href=https://1-1.link/apple-touch-icon.png>
<link rel=mask-icon href=https://1-1.link/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Advanced Operators">
<meta property="og:description" content="Unlike arithmetic operators in C, arithmetic operators in Swift don’t overflow by default. If want to overflow by default, use the overflow operation begin with ampersand (&). For example, the overflow addition operator (&+).
It’s so free to define custom infix, prefix, postfix and assignment operators, precedence and associativity values.
Bitwise Operators Here we use a function to pad 0 for the number’s print result.
func pad(num: UInt8, count: Int) -> String { var str = String(num, radix: 2) var res: String = str for _ in 0.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://1-1.link/post/language/swift/28advanced-operators/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2022-06-19T16:00:40+08:00">
<meta property="article:modified_time" content="2022-06-19T16:00:40+08:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Advanced Operators">
<meta name=twitter:description content="Unlike arithmetic operators in C, arithmetic operators in Swift don’t overflow by default. If want to overflow by default, use the overflow operation begin with ampersand (&). For example, the overflow addition operator (&+).
It’s so free to define custom infix, prefix, postfix and assignment operators, precedence and associativity values.
Bitwise Operators Here we use a function to pad 0 for the number’s print result.
func pad(num: UInt8, count: Int) -> String { var str = String(num, radix: 2) var res: String = str for _ in 0.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":3,"name":"Advanced Operators","item":"https://1-1.link/post/language/swift/28advanced-operators/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Advanced Operators","name":"Advanced Operators","description":"Unlike arithmetic operators in C, arithmetic operators in Swift don’t overflow by default. If want to overflow by default, use the overflow operation begin with ampersand (\u0026amp;). For example, the overflow addition operator (\u0026amp;+).\nIt’s so free to define custom infix, prefix, postfix and assignment operators, precedence and associativity values.\nBitwise Operators Here we use a function to pad 0 for the number’s print result.\nfunc pad(num: UInt8, count: Int) -\u0026gt; String { var str = String(num, radix: 2) var res: String = str for _ in 0.","keywords":["编程语言"],"articleBody":"Unlike arithmetic operators in C, arithmetic operators in Swift don’t overflow by default. If want to overflow by default, use the overflow operation begin with ampersand (\u0026). For example, the overflow addition operator (\u0026+).\nIt’s so free to define custom infix, prefix, postfix and assignment operators, precedence and associativity values.\nBitwise Operators Here we use a function to pad 0 for the number’s print result.\nfunc pad(num: UInt8, count: Int) - String { var str = String(num, radix: 2) var res: String = str for _ in 0..(count - str.count) { res = \"0\" + res } return res }   ~ NOT\n~1 is 0\n~0 is 1\n  \u0026 AND\n1 \u0026 1 is 1\n1 \u0026 0 is 0\n0 * 0 is 0\n  | OR\n1 | 1 is 1\n1 | 0 is 1\n0 | 0 is 0\n  ^ XOR\n1 ^ 1 is 0\n1 ^ 0 is 1\n0 ^ 0 is 0\n  Bitwise NOT Operator Use ~ to do NOT operation.\nvar a: UInt8 = 0b11111100 var b = ~a print(pad(num: b, count: 8)) // 00000011 UInt8 has 8 bits, and can store 0 to 255.\nBitwise AND Operator Use \u0026 to do AND operation.\nlet a: UInt8 = 0b11111100 let b: UInt8 = 0b00011010 let c = a \u0026 b print(pad(num: c, count: 8)) // 00011000 Bitwise OR Operator Use | to do OR operator.\nlet a: UInt8 = 0b11111100 let b: UInt8 = 0b00011010 let c = a | b print(pad(num: c, count: 8)) // 11111110 Bitwise XOR Operator Return a new number whose bits are set to 1 where the input bits are different and are set to 0 where the input bits are the same.\nlet a: UInt8 = 0b11111100 let b: UInt8 = 0b00011010 let c = a ^ b print(pad(num: c, count: 8)) // 11100110 Bitwise Left and Right Shift Operators Left shift () move all bits in a number to the left.\nlet a: UInt8 = 0b00111100 let b = a  1 let c = a  2 print(pad(num: b, count: 8)) // 01111000 print(pad(num: c, count: 8)) // 11110000 Shifting of the Unsigned Integer It will place an zero at the left when right shift, and place an zero at the right when left shift.\nRight shift () move all bits in a number to the right.\nlet a: UInt8 = 0b00111100 let b = a  1 let c = a  2 print(pad(num: b, count: 8)) // 00011110 print(pad(num: c, count: 8)) // 00001111 Use bit shifting to encode and decode values within other data types:\nlet pink: UInt32 = 0xCC6699 let redComponent = (pink \u0026 0xFF0000)  16 let greenComponent = (pink \u0026 0x00FF00)  8 let blueComponent = pink \u0026 0x0000FF print(String(redComponent, radix: 16)) // cc print(String(greenComponent, radix: 16)) // 66 print(String(blueComponent, radix: 16)) // 99 // By AND operation and shifting, we get the three part of the \"pink\" color: R G B The CSS color value #CC6699 is written as 0xCC6699 in Swift’s hexadecimal number representation.\nShifting Behavior for Signed Integer In the 8-bit signed integer example:\nSigned Integer use its first bit to indicate whether the integer is positive or negative. (0 is positive, 1 is negative)\n00000100 is 4\n11111100 is -4, the first bit 1 indicate that the integer is negative, and the remain 7 bits is 124 means that 128 - 124 = -4\nSo the signed 8-bits can represent -128(10000000) to 127(01111111).\nTwo’s Complement Representation\nThe way it’s encoded above is known as a two’s complement representation. In this way it has several advantage.\n  Add -4 and -1, it add in binary rule and discard anything that overflow.\n(-4) + (-1) = 11\n11111100 + 11111111 = 11111011\n  arithmetic shift\n  left shift: an arithmetic shift = a logical shift. It will doubling the number.\n  right shift: when shift signed integers to the right, apply same rules as for unsigned integers, but fill any empty bits on the left with the sign bit, rather than with a zero.\n11111110  1 will be 11111111 01111110  1 will be 00111111 In this way it ensures that the number will has the same sign after shifting. The shift will moves both positive and negative numbers closer to zero.\n    Overflow Operators When the constant or variable can’t hold the value that too large or too small, Swift will raise an error.\n// The num get the max value of Int8 var num = Int8.max num += 1 // Here will a runtime-error. If we specifically want an overflow condition to truncate the number of available bits, we can use the overflow operators that begin with an ampersand (\u0026).\n Overflow addition (\u0026+) Overflow subtraction (\u0026-) Overflow multiplication (\u0026*)  Value Overflow If we allow the number to overflow, it may overflows in both positive and negative direction.\nvar num: UInt8 = UInt8.max // It's 11111111 (255) num = num \u0026+ 2 print(pad(num: num, count: 8)) // 00000001 var n: UInt8 = 1 n = n \u0026- 2 print(pad(num: n, count: 8)) // 11111111 The overflow operation can be apply to signed integer.\nvar signedNum: Int8 = Int8.min // -128 signedNum = signedNum \u0026- 1 print(String(signedNum, radix: 2)) // 127 Precedence and Associativity From high to low:\n %   /     -    let a = 2 + 3 % 4 * 5 print(a) // 17 Left associative: calculate from left to right.\n * / % \u0026 \u0026* + - | ^ \u0026+ \u0026- is as as? as! \u0026\u0026 .\u0026 || .| .^  Right associative: calculate from right to left.\n ?? :? = *= /= %= += -= «=    =\n   \u0026= |= ^= \u0026*= \u0026+= \u0026-= \u0026»= \u0026«= .\u0026= .|= .^=  Isn’t associative:\n «       \u0026« \u0026»         =\n  == != === !== ~= . . . .= .== .!= .. …  Operator Methods Classes and structures can overloading the existing operators.\nstruct Vector2D { var x = 0.0, y = 0.0 } extension Vector2D { static func + (left: Vector2D, right: Vector2D) - Vector2D{ return Vector2D(x: left.x + right.x, y: left.y + right.y) } } var a = Vector2D(x: 1.0, y: 2.0) var b = Vector2D(x: 3.0, y: 3.0) var c = a + b print(c) // Vector2D(x: 4.0, y: 5.0) Prefix and Postfix Operators extension Vector2D { static prefix func - (vector: Vector2D) - Vector2D { return Vector2D(x: -vector.x, y: -vector.y) } } var x = Vector2D(x: 1.0, y: 2.0) var xx = -x print(xx) // Vector2D(x: -1.0, y: -2.0) Compound Assignment Operators +=\nextension Vector2D { static func += (left: inout Vector2D, right: Vector2D){ left = left + right } } var v = Vector2D(x: 1.0, y: 2.0) var w = Vector2D(x: 4.0, y: -3.0) v += w print(v) // Vector2D(x: 5.0, y: -1.0) Equivalence Operators ==\nOne way to make == be valid for enumeration or structure: Conform to the Equalble , it has provided method to do that.\nextension Vector2D: Equatable { } var one = Vector2D(x: 1.0, y: 2.0) var two = Vector2D(x: 1.0, y: 2.0) print(one == two) // true Another way is to implement the method in the extension.\nextension Vector2D: Equatable { static func == (left: Vector2D, right: Vector2D) - Bool { return (left.x == right.x) \u0026\u0026 (left.y == right.y) } } var one = Vector2D(x: 1.0, y: 2.0) var two = Vector2D(x: 1.0, y: 2.0) print(one == two) // true Custom Operators Prefix operator\nprefix operator +++ extension Vector2D { static prefix func +++ (vector: inout Vector2D) - Vector2D { vector += vector return vector } } var some = Vector2D(x: 1.0, y: 2.0) +++some print(some) // Vector2D(x: 2.0, y: 4.0) Precedence for Custom Infix Operators Here we define a new custom infix operator call +-, which belongs to the precedence group AdditionPrecedence.\ninfix operator +-: AdditionPrecedence exthe tension Vector2D { static func +- (left: Vector2D, right: Vector2D) - Vector2D{ return Vector2D(x: left.x + right.x, y: left.y - right.y) } } var a = Vector2D(x: 1.0, y: 2.0) var b = Vector2D(x: 2.0, y: 3.0) var c = a +- b print(c) // Vector2D(x: 3.0, y: -1.0) Don’t need to specify a precedence when defining a prefix or postfix operator. When apply both prefix and postfix to the same operand, the postfix operator is applied first.\nResult Builders If the code without result builder:\nprotocol Drawable { func draw() - String } struct Line: Drawable { var elements: [Drawable] func draw() - String{ return elements.map { $0.draw() }.joined(separator: \"\") } } struct Text: Drawable { var content: String init(_ content: String) { self.content = content } func draw() - String { return content } } struct Space: Drawable { func draw() - String { return \" \" } } struct Star: Drawable { var length: Int func draw() - String { return String(repeating: \"*\", count: length) } } struct AllCaps: Drawable { var content: Drawable func draw() - String { return content.draw().uppercased() } } let name: String? = \"Mike\" let drawing = Line(elements: [ Star(length: 3), Text(\"Hello\"), Space(), AllCaps(content: Text((name ?? \"World\") + \"!\")), Star(length: 3) ]) print(drawing.draw()) // ***Hello MIKE!*** The content in the AllCaps is awkward, if the content is complex, and have some extra conditions, it’s hard to write.\nSo we use the result builder to solve this problem.\n@resultBuilder struct DrawingBuilder { // It combines several components into a line static func buildBlock(_ components: Drawable...) - Drawable{ return Line(elements: components) } static func buildEither(first: Drawable) - Drawable{ return first } static func buildEither(second: Drawable) - Drawable { return second } } func draw(@DrawingBuilder content: () - Drawable) - Drawable { return content() } func caps(@DrawingBuilder content: () - Drawable) - Drawable { return AllCaps(content: content()) } func makeGreeting(for name: String? = nil) - Drawable { let greeting = draw { Star(length: 3) Text(\"Hello\") Space() caps { if let name = name { Text(name + \"!\") } else { Text(\"World!\") } } Star(length: 2) } return greeting } let p = makeGreeting() print(p.draw()) // ***Hello WORLD!** let s = makeGreeting(for: \"Amy\") print(s.draw()) // ***Hello AMY!** The Swift will transform the call to caps(_: ) into code like this:\nlet capsDrawing = caps { let partialDrawing: Drawable if let name = name { let text = Text(name + \"!\") partialDrawing = DrawingBuilder.buildEither(first: text) } else { let text = Text(\"World!\") partialDrawing = DrawingBuilder.buildEither(second: text) } return partialDrawing } Add support for writing for loops\nextension DrawingBuilder { static func buildArray(_ components: [Drawable]) - Drawable { return Line(elements: components) } } let manyStars = draw { Text(\"Stars:\") for length in 1...3 { Space() Stars(length: length) } } The result builder makes it easier and neater to organize the function blocks.\n","wordCount":"1769","inLanguage":"en","datePublished":"2022-06-19T16:00:40+08:00","dateModified":"2022-06-19T16:00:40+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://1-1.link/post/language/swift/28advanced-operators/"},"publisher":{"@type":"Organization","name":"CodePaper","logo":{"@type":"ImageObject","url":"https://1-1.link/favicon.ico"}}}</script>
<link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://1-1.link accesskey=h title="CodePaper (Alt + H)">CodePaper</a>
<div class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</div>
<ul id=menu>
<li>
<a href=https://1-1.link/archive/ title=📦档案>
<span>📦档案</span>
</a>
</li>
<li>
<a href=https://1-1.link/categories/ title=📖类别>
<span>📖类别</span>
</a>
</li>
<li>
<a href=https://1-1.link/tags/ title=🏷️标签>
<span>🏷️标签</span>
</a>
</li>
<li>
<a href=https://1-1.link/search/ title="🔎搜索 (Alt + /)" accesskey=/>
<span>🔎搜索</span>
</a>
</li>
<li>
<a href=https://1-1.link/about/ title=🧑‍💻关于我>
<span>🧑‍💻关于我</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://1-1.link>Home</a></div>
<h1 class=post-title>
Advanced Operators
</h1>
<div class=post-meta><span title="2022-06-19 16:00:40 +0800 CST">June 19, 2022</span>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#bitwise-operators aria-label="Bitwise Operators">Bitwise Operators</a><ul>
<li>
<a href=#bitwise-not-operator aria-label="Bitwise NOT Operator">Bitwise NOT Operator</a></li>
<li>
<a href=#bitwise-and-operator aria-label="Bitwise AND Operator">Bitwise AND Operator</a></li>
<li>
<a href=#bitwise-or-operator aria-label="Bitwise OR Operator">Bitwise OR Operator</a></li>
<li>
<a href=#bitwise-xor-operator aria-label="Bitwise XOR Operator">Bitwise XOR Operator</a></li>
<li>
<a href=#bitwise-left-and-right-shift-operators aria-label="Bitwise Left and Right Shift Operators">Bitwise Left and Right Shift Operators</a></li>
<li>
<a href=#shifting-of-the-unsigned-integer aria-label="Shifting of the Unsigned Integer">Shifting of the Unsigned Integer</a></li>
<li>
<a href=#shifting-behavior-for-signed-integer aria-label="Shifting Behavior for Signed Integer">Shifting Behavior for Signed Integer</a></li></ul>
</li>
<li>
<a href=#overflow-operators aria-label="Overflow Operators">Overflow Operators</a><ul>
<li>
<a href=#value-overflow aria-label="Value Overflow">Value Overflow</a></li></ul>
</li>
<li>
<a href=#precedence-and-associativity aria-label="Precedence and Associativity">Precedence and Associativity</a></li>
<li>
<a href=#operator-methods aria-label="Operator Methods">Operator Methods</a><ul>
<li>
<a href=#prefix-and-postfix-operators aria-label="Prefix and Postfix Operators">Prefix and Postfix Operators</a></li>
<li>
<a href=#compound-assignment-operators aria-label="Compound Assignment Operators">Compound Assignment Operators</a></li>
<li>
<a href=#equivalence-operators aria-label="Equivalence Operators">Equivalence Operators</a></li></ul>
</li>
<li>
<a href=#custom-operators aria-label="Custom Operators">Custom Operators</a><ul>
<li>
<a href=#precedence-for-custom-infix-operators aria-label="Precedence for Custom Infix Operators">Precedence for Custom Infix Operators</a></li></ul>
</li>
<li>
<a href=#result-builders aria-label="Result Builders">Result Builders</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><p>Unlike arithmetic operators in C, arithmetic operators in Swift don’t overflow by default. If want to overflow by default, use the overflow operation begin with ampersand (<code>&</code>). For example, the overflow addition operator (<code>&+</code>).</p>
<p>It’s so free to define custom infix, prefix, postfix and assignment operators, precedence and associativity values.</p>
<h2 id=bitwise-operators>Bitwise Operators<a hidden class=anchor aria-hidden=true href=#bitwise-operators>#</a></h2>
<p>Here we use a function to pad 0 for the number’s print result.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>pad</span>(num: UInt8, count: Int) -&gt; String {
    <span style=color:#66d9ef>var</span> str = String(num, radix: <span style=color:#ae81ff>2</span>)
    <span style=color:#66d9ef>var</span> res: String = str
    <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>_</span> <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>0.</span>.<span style=color:#f92672>&lt;</span>(count <span style=color:#f92672>-</span> str.count) {
        res = <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>+</span> res
    }
    
    <span style=color:#66d9ef>return</span>  res
    
}
</code></pre></div><ul>
<li>
<p><code>~</code> NOT</p>
<p>~1 is 0</p>
<p>~0 is 1</p>
</li>
<li>
<p><code>&</code> AND</p>
<p>1 & 1 is 1</p>
<p>1 & 0 is 0</p>
<p>0 * 0 is 0</p>
</li>
<li>
<p><code>|</code> OR</p>
<p>1 | 1 is 1</p>
<p>1 | 0 is 1</p>
<p>0 | 0 is 0</p>
</li>
<li>
<p><code>^</code> XOR</p>
<p>1 ^ 1 is 0</p>
<p>1 ^ 0 is 1</p>
<p>0 ^ 0 is 0</p>
</li>
</ul>
<h3 id=bitwise-not-operator>Bitwise NOT Operator<a hidden class=anchor aria-hidden=true href=#bitwise-not-operator>#</a></h3>
<p>Use <code>~</code> to do NOT operation.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>var</span> a: UInt8 = <span style=color:#ae81ff>0b11111100</span>
<span style=color:#66d9ef>var</span> b = <span style=color:#f92672>~</span>a
print(pad(num: b, count: <span style=color:#ae81ff>8</span>))  <span style=color:#75715e>// 00000011</span>
</code></pre></div><p><code>UInt8</code> has 8 bits, and can store 0 to 255.</p>
<h3 id=bitwise-and-operator>Bitwise AND Operator<a hidden class=anchor aria-hidden=true href=#bitwise-and-operator>#</a></h3>
<p>Use <code>&</code> to do AND operation.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> a: UInt8 = <span style=color:#ae81ff>0b11111100</span>
<span style=color:#66d9ef>let</span> b: UInt8 = <span style=color:#ae81ff>0b00011010</span>
<span style=color:#66d9ef>let</span> c = a <span style=color:#f92672>&amp;</span> b
print(pad(num: c, count: <span style=color:#ae81ff>8</span>)) <span style=color:#75715e>// 00011000</span>
</code></pre></div><h3 id=bitwise-or-operator>Bitwise OR Operator<a hidden class=anchor aria-hidden=true href=#bitwise-or-operator>#</a></h3>
<p>Use <code>|</code> to do OR operator.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> a: UInt8 = <span style=color:#ae81ff>0b11111100</span>
<span style=color:#66d9ef>let</span> b: UInt8 = <span style=color:#ae81ff>0b00011010</span>
<span style=color:#66d9ef>let</span> c = a <span style=color:#f92672>|</span> b
print(pad(num: c, count: <span style=color:#ae81ff>8</span>))  <span style=color:#75715e>// 11111110</span>
</code></pre></div><h3 id=bitwise-xor-operator>Bitwise XOR Operator<a hidden class=anchor aria-hidden=true href=#bitwise-xor-operator>#</a></h3>
<p>Return a new number whose bits are set to 1 where the input bits are different and are set to 0 where the input bits are the same.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> a: UInt8 = <span style=color:#ae81ff>0b11111100</span>
<span style=color:#66d9ef>let</span> b: UInt8 = <span style=color:#ae81ff>0b00011010</span>
<span style=color:#66d9ef>let</span> c = a <span style=color:#f92672>^</span> b
print(pad(num: c, count: <span style=color:#ae81ff>8</span>))  <span style=color:#75715e>// 11100110</span>
</code></pre></div><h3 id=bitwise-left-and-right-shift-operators>Bitwise Left and Right Shift Operators<a hidden class=anchor aria-hidden=true href=#bitwise-left-and-right-shift-operators>#</a></h3>
<p>Left shift (<code>&lt;&lt;</code>) move all bits in a number to the left.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> a: UInt8 = <span style=color:#ae81ff>0b00111100</span>
<span style=color:#66d9ef>let</span> b = a <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>1</span>
<span style=color:#66d9ef>let</span> c = a <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>2</span>
print(pad(num: b, count: <span style=color:#ae81ff>8</span>))  <span style=color:#75715e>// 01111000</span>
print(pad(num: c, count: <span style=color:#ae81ff>8</span>))  <span style=color:#75715e>// 11110000</span>
</code></pre></div><h3 id=shifting-of-the-unsigned-integer>Shifting of the Unsigned Integer<a hidden class=anchor aria-hidden=true href=#shifting-of-the-unsigned-integer>#</a></h3>
<p>It will place an zero at the left when right shift, and place an zero at the right when left shift.</p>
<p>Right shift (<code>>></code>) move all bits in a number to the right.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> a: UInt8 = <span style=color:#ae81ff>0b00111100</span>
<span style=color:#66d9ef>let</span> b = a <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>
<span style=color:#66d9ef>let</span> c = a <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2</span>
print(pad(num: b, count: <span style=color:#ae81ff>8</span>))  <span style=color:#75715e>// 00011110</span>
print(pad(num: c, count: <span style=color:#ae81ff>8</span>))  <span style=color:#75715e>// 00001111</span>
</code></pre></div><p>Use bit shifting to encode and decode values within other data types:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> pink: UInt32 = <span style=color:#ae81ff>0xCC6699</span>
<span style=color:#66d9ef>let</span> redComponent = (pink <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF0000</span>) <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>16</span>
<span style=color:#66d9ef>let</span> greenComponent = (pink <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x00FF00</span>) <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>8</span>
<span style=color:#66d9ef>let</span> blueComponent = pink <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x0000FF</span>
print(String(redComponent, radix: <span style=color:#ae81ff>16</span>))   <span style=color:#75715e>// cc</span>
print(String(greenComponent, radix: <span style=color:#ae81ff>16</span>)) <span style=color:#75715e>// 66</span>
print(String(blueComponent, radix: <span style=color:#ae81ff>16</span>))  <span style=color:#75715e>// 99</span>

<span style=color:#75715e>// By AND operation and shifting, we get the three part of the &#34;pink&#34; color: R G B</span>
</code></pre></div><p>The CSS color value <code>#CC6699</code> is written as <code>0xCC6699</code> in Swift’s hexadecimal number representation.</p>
<h3 id=shifting-behavior-for-signed-integer>Shifting Behavior for Signed Integer<a hidden class=anchor aria-hidden=true href=#shifting-behavior-for-signed-integer>#</a></h3>
<p>I<strong>n the 8-bit signed integer example:</strong></p>
<p>Signed Integer use its first bit to indicate whether the integer is positive or negative. (0 is positive, 1 is negative)</p>
<p><code>00000100</code> is 4</p>
<p><code>11111100</code> is -4, the first bit 1 indicate that the integer is negative, and the <strong>remain 7 bits</strong> is 124 means that 128 - 124 = -4</p>
<p>So the signed 8-bits can represent <strong>-128(10000000) to 127(01111111)</strong>.</p>
<p>Two’s Complement Representation</p>
<p>The way it’s encoded above is known as a <em>two’s complement</em> representation. In this way it has several advantage.</p>
<ul>
<li>
<p>Add -4 and -1, it add in binary rule and discard anything that overflow.</p>
<p>(-4) + (-1) = 11</p>
<p>11111100 + 11111111 = 11111011</p>
</li>
<li>
<p>arithmetic shift</p>
<ul>
<li>
<p>left shift: an arithmetic shift = a logical shift. It will doubling the number.</p>
</li>
<li>
<p>right shift: when shift signed integers to the right, apply same rules as for unsigned integers, but fill any empty bits on the left <strong>with the sign bit,</strong> rather than with a zero.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#ae81ff>11111110</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span> will be <span style=color:#ae81ff>11111111</span>
<span style=color:#ae81ff>01111110</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span> will be <span style=color:#ae81ff>00111111</span>
</code></pre></div><p>In this way it ensures that the number will has the same sign after shifting. The shift will moves both positive and negative numbers closer to zero.</p>
</li>
</ul>
</li>
</ul>
<h2 id=overflow-operators>Overflow Operators<a hidden class=anchor aria-hidden=true href=#overflow-operators>#</a></h2>
<p>When the constant or variable can’t hold the value that too large or too small, Swift will raise an error.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#75715e>// The num get the max value of Int8</span>
<span style=color:#66d9ef>var</span> num = Int8.max

num <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>  <span style=color:#75715e>// Here will a runtime-error.</span>
</code></pre></div><p>If we specifically want an overflow condition to truncate the number of available bits, we can use the overflow operators that begin with an ampersand (&).</p>
<ul>
<li>Overflow addition (&+)</li>
<li>Overflow subtraction (&-)</li>
<li>Overflow multiplication (&*)</li>
</ul>
<h3 id=value-overflow>Value Overflow<a hidden class=anchor aria-hidden=true href=#value-overflow>#</a></h3>
<p>If we allow the number to overflow, it may overflows in both positive and negative direction.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>var</span> num: UInt8 = UInt8.max      <span style=color:#75715e>// It&#39;s 11111111 (255)</span>
num = num <span style=color:#f92672>&amp;+</span> <span style=color:#ae81ff>2</span>

print(pad(num: num, count: <span style=color:#ae81ff>8</span>))  <span style=color:#75715e>// 00000001</span>

<span style=color:#66d9ef>var</span> n: UInt8 = <span style=color:#ae81ff>1</span>
n = n <span style=color:#f92672>&amp;-</span> <span style=color:#ae81ff>2</span>
print(pad(num: n, count: <span style=color:#ae81ff>8</span>))    <span style=color:#75715e>// 11111111</span>
</code></pre></div><p>The overflow operation can be apply to signed integer.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>var</span> signedNum: Int8 = Int8.min     <span style=color:#75715e>// -128</span>
signedNum = signedNum <span style=color:#f92672>&amp;-</span> <span style=color:#ae81ff>1</span>
print(String(signedNum, radix: <span style=color:#ae81ff>2</span>)) <span style=color:#75715e>// 127</span>
</code></pre></div><h2 id=precedence-and-associativity>Precedence and Associativity<a hidden class=anchor aria-hidden=true href=#precedence-and-associativity>#</a></h2>
<p>From high to low:</p>
<ul>
<li>%</li>
<li>
<ul>
<li>/</li>
</ul>
</li>
<li>
<ul>
<li>-</li>
</ul>
</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> a = <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>5</span>
print(a)  <span style=color:#75715e>// 17</span>
</code></pre></div><p><strong>Left associative</strong>: calculate from left to right.</p>
<ul>
<li>*</li>
<li>/</li>
<li>%</li>
<li>&</li>
<li>&*</li>
<li>+</li>
<li>-</li>
<li>|</li>
<li>^</li>
<li>&+</li>
<li>&-</li>
<li>is</li>
<li>as</li>
<li>as?</li>
<li>as!</li>
<li>&&</li>
<li>.&</li>
<li>||</li>
<li>.|</li>
<li>.^</li>
</ul>
<p><strong>Right associative</strong>: calculate from right to left.</p>
<ul>
<li>??</li>
<li>:?</li>
<li>=</li>
<li>*=</li>
<li>/=</li>
<li>%=</li>
<li>+=</li>
<li>-=</li>
<li>&#171;=</li>
<li>
<blockquote>
<blockquote>
<p>=</p>
</blockquote>
</blockquote>
</li>
<li>&=</li>
<li>|=</li>
<li>^=</li>
<li>&*=</li>
<li>&+=</li>
<li>&-=</li>
<li>&&#187;=</li>
<li>&&#171;=</li>
<li>.&=</li>
<li>.|=</li>
<li>.^=</li>
</ul>
<p><strong>Isn’t associative</strong>:</p>
<ul>
<li>&#171;</li>
<li>
<blockquote>
<blockquote>
</blockquote>
</blockquote>
</li>
<li>&&#171;</li>
<li>&&#187;</li>
<li>&lt;</li>
<li>&lt;=</li>
<li>
<blockquote>
</blockquote>
</li>
<li>
<blockquote>
<p>=</p>
</blockquote>
</li>
<li>==</li>
<li>!=</li>
<li>===</li>
<li>!==</li>
<li>~=</li>
<li>.&lt;</li>
<li>.&lt;=</li>
<li>.></li>
<li>.>=</li>
<li>.==</li>
<li>.!=</li>
<li>..&lt;</li>
<li>…</li>
</ul>
<h2 id=operator-methods>Operator Methods<a hidden class=anchor aria-hidden=true href=#operator-methods>#</a></h2>
<p>Classes and structures can overloading the existing operators.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Vector2D</span> {
    <span style=color:#66d9ef>var</span> x = <span style=color:#ae81ff>0.0</span>, y = <span style=color:#ae81ff>0.0</span>
}

<span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Vector2D</span> {
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#f92672>+</span> (<span style=color:#66d9ef>left</span>: Vector2D, <span style=color:#66d9ef>right</span>: Vector2D) -&gt; Vector2D{
        <span style=color:#66d9ef>return</span> Vector2D(x: <span style=color:#66d9ef>left</span>.x <span style=color:#f92672>+</span> <span style=color:#66d9ef>right</span>.x, y: <span style=color:#66d9ef>left</span>.y <span style=color:#f92672>+</span> <span style=color:#66d9ef>right</span>.y)
    }
}

<span style=color:#66d9ef>var</span> a = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)
<span style=color:#66d9ef>var</span> b = Vector2D(x: <span style=color:#ae81ff>3.0</span>, y: <span style=color:#ae81ff>3.0</span>)
<span style=color:#66d9ef>var</span> c = a <span style=color:#f92672>+</span> b
print(c)  <span style=color:#75715e>// Vector2D(x: 4.0, y: 5.0)</span>
</code></pre></div><h3 id=prefix-and-postfix-operators>Prefix and Postfix Operators<a hidden class=anchor aria-hidden=true href=#prefix-and-postfix-operators>#</a></h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Vector2D</span> {
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>prefix</span> <span style=color:#66d9ef>func</span> <span style=color:#f92672>-</span> (vector: Vector2D) -&gt; Vector2D {
        <span style=color:#66d9ef>return</span> Vector2D(x: <span style=color:#f92672>-</span>vector.x, y: <span style=color:#f92672>-</span>vector.y)
    }  
}
<span style=color:#66d9ef>var</span> x = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)
<span style=color:#66d9ef>var</span> xx = <span style=color:#f92672>-</span>x
print(xx)   <span style=color:#75715e>// Vector2D(x: -1.0, y: -2.0)</span>
</code></pre></div><h3 id=compound-assignment-operators>Compound Assignment Operators<a hidden class=anchor aria-hidden=true href=#compound-assignment-operators>#</a></h3>
<p>+=</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Vector2D</span> {
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#f92672>+=</span> (<span style=color:#66d9ef>left</span>: <span style=color:#66d9ef>inout</span> Vector2D, <span style=color:#66d9ef>right</span>: Vector2D){
        <span style=color:#66d9ef>left</span> = <span style=color:#66d9ef>left</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>right</span>
    }
}
<span style=color:#66d9ef>var</span> v = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)
<span style=color:#66d9ef>var</span> w = Vector2D(x: <span style=color:#ae81ff>4.0</span>, y: <span style=color:#f92672>-</span><span style=color:#ae81ff>3.0</span>)

v <span style=color:#f92672>+=</span> w
print(v)  <span style=color:#75715e>// Vector2D(x: 5.0, y: -1.0)</span>
</code></pre></div><h3 id=equivalence-operators>Equivalence Operators<a hidden class=anchor aria-hidden=true href=#equivalence-operators>#</a></h3>
<p>==</p>
<p>One way to make <code>==</code> be valid for enumeration or structure: Conform to the <code>Equalble</code> , it has provided method to do that.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Vector2D</span>: Equatable {
    
}

<span style=color:#66d9ef>var</span> one = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)
<span style=color:#66d9ef>var</span> two = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)

print(one == two)  <span style=color:#75715e>// true</span>
</code></pre></div><p>Another way is to implement the method in the extension.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Vector2D</span>: Equatable {
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> == (<span style=color:#66d9ef>left</span>: Vector2D, <span style=color:#66d9ef>right</span>: Vector2D) -&gt; Bool {
        <span style=color:#66d9ef>return</span> (<span style=color:#66d9ef>left</span>.x == <span style=color:#66d9ef>right</span>.x) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#66d9ef>left</span>.y == <span style=color:#66d9ef>right</span>.y)
    }
}

<span style=color:#66d9ef>var</span> one = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)
<span style=color:#66d9ef>var</span> two = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)

print(one == two)  <span style=color:#75715e>// true</span>
</code></pre></div><h2 id=custom-operators>Custom Operators<a hidden class=anchor aria-hidden=true href=#custom-operators>#</a></h2>
<p>Prefix operator</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>prefix</span> <span style=color:#66d9ef>operator</span> <span style=color:#f92672>+++</span>  
<span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Vector2D</span> {
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>prefix</span> <span style=color:#66d9ef>func</span> <span style=color:#f92672>+++</span> (vector: <span style=color:#66d9ef>inout</span> Vector2D) -&gt; Vector2D {
        vector <span style=color:#f92672>+=</span> vector
        <span style=color:#66d9ef>return</span> vector
    }
}

<span style=color:#66d9ef>var</span> some = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)
    <span style=color:#f92672>+++</span>some

print(some)   <span style=color:#75715e>// Vector2D(x: 2.0, y: 4.0)</span>
</code></pre></div><h3 id=precedence-for-custom-infix-operators>Precedence for Custom Infix Operators<a hidden class=anchor aria-hidden=true href=#precedence-for-custom-infix-operators>#</a></h3>
<p>Here we define a new custom infix operator call +-, which belongs to the precedence group <code>AdditionPrecedence</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>infix</span> <span style=color:#66d9ef>operator</span> <span style=color:#f92672>+-</span>: AdditionPrecedence
exthe tension Vector2D {
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#f92672>+-</span> (<span style=color:#66d9ef>left</span>: Vector2D, <span style=color:#66d9ef>right</span>: Vector2D) -&gt; Vector2D{
        <span style=color:#66d9ef>return</span> Vector2D(x: <span style=color:#66d9ef>left</span>.x <span style=color:#f92672>+</span> <span style=color:#66d9ef>right</span>.x, y: <span style=color:#66d9ef>left</span>.y <span style=color:#f92672>-</span> <span style=color:#66d9ef>right</span>.y)
    }
}

<span style=color:#66d9ef>var</span> a = Vector2D(x: <span style=color:#ae81ff>1.0</span>, y: <span style=color:#ae81ff>2.0</span>)
<span style=color:#66d9ef>var</span> b = Vector2D(x: <span style=color:#ae81ff>2.0</span>, y: <span style=color:#ae81ff>3.0</span>)
<span style=color:#66d9ef>var</span> c = a <span style=color:#f92672>+-</span> b

print(c) <span style=color:#75715e>// Vector2D(x: 3.0, y: -1.0)</span>
</code></pre></div><p>Don’t need to specify a precedence when defining a prefix or postfix operator. When apply both prefix and postfix to the same operand, the postfix operator is applied first.</p>
<h2 id=result-builders>Result Builders<a hidden class=anchor aria-hidden=true href=#result-builders>#</a></h2>
<p>If the code without result builder:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Drawable</span> {
    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>draw</span>() -&gt; String
}
<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Line</span>: Drawable {
    <span style=color:#66d9ef>var</span> elements: [Drawable]
    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>draw</span>() -&gt; String{
        <span style=color:#66d9ef>return</span>  elements.map { $0.draw() }.joined(separator: <span style=color:#e6db74>&#34;&#34;</span>)
    }
}

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Text</span>: Drawable {
    <span style=color:#66d9ef>var</span> content: String
    <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> content: String) {
        <span style=color:#66d9ef>self</span>.content = content
    }
    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>draw</span>() -&gt; String {
        <span style=color:#66d9ef>return</span> content
    }
}

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Space</span>: Drawable {
    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>draw</span>() -&gt; String {
        <span style=color:#66d9ef>return</span>  <span style=color:#e6db74>&#34; &#34;</span>
    }
}

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Star</span>: Drawable {
    <span style=color:#66d9ef>var</span> length: Int
    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>draw</span>() -&gt; String {
        <span style=color:#66d9ef>return</span> String(repeating: <span style=color:#e6db74>&#34;*&#34;</span>, count: length)
    }
}

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>AllCaps</span>: Drawable {
    <span style=color:#66d9ef>var</span> content: Drawable
    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>draw</span>() -&gt; String {
        <span style=color:#66d9ef>return</span> content.draw().uppercased()
    }
}

<span style=color:#66d9ef>let</span> name: String? = <span style=color:#e6db74>&#34;Mike&#34;</span>
<span style=color:#66d9ef>let</span> drawing = Line(elements: [
    Star(length: <span style=color:#ae81ff>3</span>),
    Text(<span style=color:#e6db74>&#34;Hello&#34;</span>),
    Space(),
    AllCaps(content: Text((name ?? <span style=color:#e6db74>&#34;World&#34;</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;!&#34;</span>)),
    Star(length: <span style=color:#ae81ff>3</span>)
])

print(drawing.draw())  <span style=color:#75715e>// ***Hello MIKE!***</span>
</code></pre></div><p>The content in the <code>AllCaps</code> is awkward, <strong>if the content is complex</strong>, and have some extra conditions, it’s hard to write.</p>
<p>So we use the <strong>result builder</strong> to solve this problem.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift>@resultBuilder 
<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>DrawingBuilder</span> {
    <span style=color:#75715e>// It combines several components into a line</span>
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildBlock</span>(<span style=color:#66d9ef>_</span> components: Drawable...) -&gt; Drawable{
        <span style=color:#66d9ef>return</span> Line(elements: components)
    }
    
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildEither</span>(first: Drawable) -&gt; Drawable{
        <span style=color:#66d9ef>return</span> first
    }
    
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildEither</span>(second: Drawable) -&gt; Drawable {
        <span style=color:#66d9ef>return</span> second
    }
    
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>draw</span>(@DrawingBuilder content: () -&gt; Drawable) -&gt; Drawable {
    <span style=color:#66d9ef>return</span> content()
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>caps</span>(@DrawingBuilder content: () -&gt; Drawable) -&gt; Drawable {
    <span style=color:#66d9ef>return</span> AllCaps(content: content())
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeGreeting</span>(<span style=color:#66d9ef>for</span> name: String? = <span style=color:#66d9ef>nil</span>) -&gt; Drawable {
    <span style=color:#66d9ef>let</span> greeting = draw {
        Star(length: <span style=color:#ae81ff>3</span>)
        Text(<span style=color:#e6db74>&#34;Hello&#34;</span>)
        Space()
        caps {
            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> name = name {
                Text(name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;!&#34;</span>)
            } <span style=color:#66d9ef>else</span> {
                Text(<span style=color:#e6db74>&#34;World!&#34;</span>)
            }
        }
        Star(length: <span style=color:#ae81ff>2</span>)
    }
    <span style=color:#66d9ef>return</span>  greeting
}

<span style=color:#66d9ef>let</span> p = makeGreeting()
print(p.draw())        <span style=color:#75715e>// ***Hello WORLD!**</span>
<span style=color:#66d9ef>let</span> s = makeGreeting(<span style=color:#66d9ef>for</span>: <span style=color:#e6db74>&#34;Amy&#34;</span>)
print(s.draw())        <span style=color:#75715e>// ***Hello AMY!**</span>
</code></pre></div><p>The Swift will transform the call to caps(_: ) into code like this:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>let</span> capsDrawing = caps {
    <span style=color:#66d9ef>let</span> partialDrawing: Drawable
    <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> name = name {
        <span style=color:#66d9ef>let</span> text = Text(name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;!&#34;</span>)
        partialDrawing = DrawingBuilder.buildEither(first: text)
    } <span style=color:#66d9ef>else</span> {
        <span style=color:#66d9ef>let</span> text = Text(<span style=color:#e6db74>&#34;World!&#34;</span>)
        partialDrawing = DrawingBuilder.buildEither(second: text)
    }
    <span style=color:#66d9ef>return</span> partialDrawing
}
</code></pre></div><p>Add support for writing <code>for</code> loops</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>DrawingBuilder</span> {
    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildArray</span>(<span style=color:#66d9ef>_</span> components: [Drawable]) -&gt; Drawable {
        <span style=color:#66d9ef>return</span> Line(elements: components)
    }
}

<span style=color:#66d9ef>let</span> manyStars = draw {
    Text(<span style=color:#e6db74>&#34;Stars:&#34;</span>)
    <span style=color:#66d9ef>for</span> length <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1.</span>..<span style=color:#ae81ff>3</span> {
        Space()
        Stars(length: length)
    }
}
</code></pre></div><p>The result builder makes it easier and neater to organize the function blocks.</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://1-1.link/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/>编程语言</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://1-1.link/post/design-pattern/all-design-pattern/>
<span class=title>« Prev</span>
<br>
<span>各种设计模式</span>
</a>
<a class=next href=https://1-1.link/post/language/swift/27access-control/>
<span class=title>Next »</span>
<br>
<span>Access Control</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Advanced Operators on twitter" href="https://twitter.com/intent/tweet/?text=Advanced%20Operators&url=https%3a%2f%2f1-1.link%2fpost%2flanguage%2fswift%2f28advanced-operators%2f&hashtags=%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Advanced Operators on reddit" href="https://reddit.com/submit?url=https%3a%2f%2f1-1.link%2fpost%2flanguage%2fswift%2f28advanced-operators%2f&title=Advanced%20Operators"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Advanced Operators on telegram" href="https://telegram.me/share/url?text=Advanced%20Operators&url=https%3a%2f%2f1-1.link%2fpost%2flanguage%2fswift%2f28advanced-operators%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2023 <a href=https://1-1.link>CodePaper</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerHTML='copy';function d(){a.innerHTML='copied!',setTimeout(()=>{a.innerHTML='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>