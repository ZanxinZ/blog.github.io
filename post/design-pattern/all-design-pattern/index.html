<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>å„ç§è®¾è®¡æ¨¡å¼ | CodePaper</title>
<meta name=keywords content="è®¾è®¡æ¨¡å¼"><meta name=description content='Creational
Object Created Pattern
Factory Method
Provide the method for creating an instance in the superclass, and allow the subclass to choose the type of the instance.
åœ¨çˆ¶ç±»ä¸­æä¾›åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚
å…·å¤‡çš„éƒ¨åˆ†ï¼šç”Ÿäº§è€…åè®®ã€äº§å“åè®®ï¼Œå¾€åå°±å¯ä»¥æ ¹æ®éœ€è¦æ¥æ‰©å±•æ¯ä¸€ç§äº§å“ã€‚

å…·ä½“çš„ç”Ÿäº§è€…æ¯”å¦‚ MongoCakeCreator çš„å­˜åœ¨æ˜¯ä¸ºäº†å®ç°ä¸äº§å“ç›¸å…³çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ›å»º MongoCake å®ä¾‹ã€‚å·¥å‚æ–¹æ³•å°†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»å…·ä½“äº§å“ç±»ä¸­åˆ†ç¦»å‡ºæ¥ã€‚
    // Creator
    protocol CakeCreator {
        func createCake() -> Cake
        func doSomethingForCake(cake: Cake) -> Cake
    }
    
    // Product
    protocol Cake {
        func doWork()
    }
    
    // ConcreteCreator
    class MongoCakeCreator: CakeCreator {
        var cake: MongoCake?
        func createCake() -> Cake {
            var cake = MongoCake()
            doSomethingForCake(cake: cake)
            return cake
        }
        func doSomethingForCake(cake: Cake) -> Cake{
            cake.doWork()
            cake.doWork()
            return cake
        }
        
    }
    
    // ConcreteCreator
    class ChocolateCakeCreator: CakeCreator {
        func createCake() -> Cake {
            var cake = ChocolateCake()
            doSomethingForCake(cake: cake)
            return cake
        }
        
        func doSomethingForCake(cake: Cake) -> Cake{
            cake.doWork()
            return cake
        }
    }
    
    class MongoCake: Cake {
        func doWork() {
            print("Add some mongo")
        }
    }
    
    class ChocolateCake: Cake {
        func doWork() {
            print("Add some chocolate")
        }
    }
    
    // If we want to add a type of cake call "PinapleCake", just need to 
    // make it conform to Cake and add a creator that conform to the CakeCreator for the "PinapleCake"
    
    let cakeOne = MongoCakeCreator().createCake()
Abstract Factory
Base on the factory method, add an abstract factory. We can call the same abstract factory method to create different modeâ€™s product. If we want to create another modeâ€™s product, we need to change the concrete factory.'><meta name=author content><link rel=canonical href=https://wowios.com/post/design-pattern/all-design-pattern/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://wowios.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wowios.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wowios.com/favicon-32x32.png><link rel=apple-touch-icon href=https://wowios.com/apple-touch-icon.png><link rel=mask-icon href=https://wowios.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://wowios.com/post/design-pattern/all-design-pattern/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://wowios.com/post/design-pattern/all-design-pattern/"><meta property="og:site_name" content="CodePaper"><meta property="og:title" content="å„ç§è®¾è®¡æ¨¡å¼"><meta property="og:description" content='Creational Object Created Pattern
Factory Method Provide the method for creating an instance in the superclass, and allow the subclass to choose the type of the instance.
åœ¨çˆ¶ç±»ä¸­æä¾›åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚
å…·å¤‡çš„éƒ¨åˆ†ï¼šç”Ÿäº§è€…åè®®ã€äº§å“åè®®ï¼Œå¾€åå°±å¯ä»¥æ ¹æ®éœ€è¦æ¥æ‰©å±•æ¯ä¸€ç§äº§å“ã€‚
å…·ä½“çš„ç”Ÿäº§è€…æ¯”å¦‚ MongoCakeCreator çš„å­˜åœ¨æ˜¯ä¸ºäº†å®ç°ä¸äº§å“ç›¸å…³çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ›å»º MongoCake å®ä¾‹ã€‚å·¥å‚æ–¹æ³•å°†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»å…·ä½“äº§å“ç±»ä¸­åˆ†ç¦»å‡ºæ¥ã€‚
// Creator protocol CakeCreator { func createCake() -> Cake func doSomethingForCake(cake: Cake) -> Cake } // Product protocol Cake { func doWork() } // ConcreteCreator class MongoCakeCreator: CakeCreator { var cake: MongoCake? func createCake() -> Cake { var cake = MongoCake() doSomethingForCake(cake: cake) return cake } func doSomethingForCake(cake: Cake) -> Cake{ cake.doWork() cake.doWork() return cake } } // ConcreteCreator class ChocolateCakeCreator: CakeCreator { func createCake() -> Cake { var cake = ChocolateCake() doSomethingForCake(cake: cake) return cake } func doSomethingForCake(cake: Cake) -> Cake{ cake.doWork() return cake } } class MongoCake: Cake { func doWork() { print("Add some mongo") } } class ChocolateCake: Cake { func doWork() { print("Add some chocolate") } } // If we want to add a type of cake call "PinapleCake", just need to // make it conform to Cake and add a creator that conform to the CakeCreator for the "PinapleCake" let cakeOne = MongoCakeCreator().createCake() Abstract Factory Base on the factory method, add an abstract factory. We can call the same abstract factory method to create different modeâ€™s product. If we want to create another modeâ€™s product, we need to change the concrete factory.'><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-07-11T18:27:35+08:00"><meta property="article:modified_time" content="2022-07-11T18:27:35+08:00"><meta property="article:tag" content="è®¾è®¡æ¨¡å¼"><meta name=twitter:card content="summary"><meta name=twitter:title content="å„ç§è®¾è®¡æ¨¡å¼"><meta name=twitter:description content='Creational
Object Created Pattern
Factory Method
Provide the method for creating an instance in the superclass, and allow the subclass to choose the type of the instance.
åœ¨çˆ¶ç±»ä¸­æä¾›åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚
å…·å¤‡çš„éƒ¨åˆ†ï¼šç”Ÿäº§è€…åè®®ã€äº§å“åè®®ï¼Œå¾€åå°±å¯ä»¥æ ¹æ®éœ€è¦æ¥æ‰©å±•æ¯ä¸€ç§äº§å“ã€‚

å…·ä½“çš„ç”Ÿäº§è€…æ¯”å¦‚ MongoCakeCreator çš„å­˜åœ¨æ˜¯ä¸ºäº†å®ç°ä¸äº§å“ç›¸å…³çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ›å»º MongoCake å®ä¾‹ã€‚å·¥å‚æ–¹æ³•å°†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»å…·ä½“äº§å“ç±»ä¸­åˆ†ç¦»å‡ºæ¥ã€‚
    // Creator
    protocol CakeCreator {
        func createCake() -> Cake
        func doSomethingForCake(cake: Cake) -> Cake
    }
    
    // Product
    protocol Cake {
        func doWork()
    }
    
    // ConcreteCreator
    class MongoCakeCreator: CakeCreator {
        var cake: MongoCake?
        func createCake() -> Cake {
            var cake = MongoCake()
            doSomethingForCake(cake: cake)
            return cake
        }
        func doSomethingForCake(cake: Cake) -> Cake{
            cake.doWork()
            cake.doWork()
            return cake
        }
        
    }
    
    // ConcreteCreator
    class ChocolateCakeCreator: CakeCreator {
        func createCake() -> Cake {
            var cake = ChocolateCake()
            doSomethingForCake(cake: cake)
            return cake
        }
        
        func doSomethingForCake(cake: Cake) -> Cake{
            cake.doWork()
            return cake
        }
    }
    
    class MongoCake: Cake {
        func doWork() {
            print("Add some mongo")
        }
    }
    
    class ChocolateCake: Cake {
        func doWork() {
            print("Add some chocolate")
        }
    }
    
    // If we want to add a type of cake call "PinapleCake", just need to 
    // make it conform to Cake and add a creator that conform to the CakeCreator for the "PinapleCake"
    
    let cakeOne = MongoCakeCreator().createCake()
Abstract Factory
Base on the factory method, add an abstract factory. We can call the same abstract factory method to create different modeâ€™s product. If we want to create another modeâ€™s product, we need to change the concrete factory.'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wowios.com/post/"},{"@type":"ListItem","position":2,"name":"å„ç§è®¾è®¡æ¨¡å¼","item":"https://wowios.com/post/design-pattern/all-design-pattern/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"å„ç§è®¾è®¡æ¨¡å¼","name":"å„ç§è®¾è®¡æ¨¡å¼","description":"Creational Object Created Pattern\nFactory Method Provide the method for creating an instance in the superclass, and allow the subclass to choose the type of the instance.\nåœ¨çˆ¶ç±»ä¸­æä¾›åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚\nå…·å¤‡çš„éƒ¨åˆ†ï¼šç”Ÿäº§è€…åè®®ã€äº§å“åè®®ï¼Œå¾€åå°±å¯ä»¥æ ¹æ®éœ€è¦æ¥æ‰©å±•æ¯ä¸€ç§äº§å“ã€‚\nå…·ä½“çš„ç”Ÿäº§è€…æ¯”å¦‚ MongoCakeCreator çš„å­˜åœ¨æ˜¯ä¸ºäº†å®ç°ä¸äº§å“ç›¸å…³çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ›å»º MongoCake å®ä¾‹ã€‚å·¥å‚æ–¹æ³•å°†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»å…·ä½“äº§å“ç±»ä¸­åˆ†ç¦»å‡ºæ¥ã€‚\n// Creator protocol CakeCreator { func createCake() -\u0026gt; Cake func doSomethingForCake(cake: Cake) -\u0026gt; Cake } // Product protocol Cake { func doWork() } // ConcreteCreator class MongoCakeCreator: CakeCreator { var cake: MongoCake? func createCake() -\u0026gt; Cake { var cake = MongoCake() doSomethingForCake(cake: cake) return cake } func doSomethingForCake(cake: Cake) -\u0026gt; Cake{ cake.doWork() cake.doWork() return cake } } // ConcreteCreator class ChocolateCakeCreator: CakeCreator { func createCake() -\u0026gt; Cake { var cake = ChocolateCake() doSomethingForCake(cake: cake) return cake } func doSomethingForCake(cake: Cake) -\u0026gt; Cake{ cake.doWork() return cake } } class MongoCake: Cake { func doWork() { print(\u0026#34;Add some mongo\u0026#34;) } } class ChocolateCake: Cake { func doWork() { print(\u0026#34;Add some chocolate\u0026#34;) } } // If we want to add a type of cake call \u0026#34;PinapleCake\u0026#34;, just need to // make it conform to Cake and add a creator that conform to the CakeCreator for the \u0026#34;PinapleCake\u0026#34; let cakeOne = MongoCakeCreator().createCake() Abstract Factory Base on the factory method, add an abstract factory. We can call the same abstract factory method to create different modeâ€™s product. If we want to create another modeâ€™s product, we need to change the concrete factory.\n","keywords":["è®¾è®¡æ¨¡å¼"],"articleBody":"Creational Object Created Pattern\nFactory Method Provide the method for creating an instance in the superclass, and allow the subclass to choose the type of the instance.\nåœ¨çˆ¶ç±»ä¸­æä¾›åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚\nå…·å¤‡çš„éƒ¨åˆ†ï¼šç”Ÿäº§è€…åè®®ã€äº§å“åè®®ï¼Œå¾€åå°±å¯ä»¥æ ¹æ®éœ€è¦æ¥æ‰©å±•æ¯ä¸€ç§äº§å“ã€‚\nå…·ä½“çš„ç”Ÿäº§è€…æ¯”å¦‚ MongoCakeCreator çš„å­˜åœ¨æ˜¯ä¸ºäº†å®ç°ä¸äº§å“ç›¸å…³çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ›å»º MongoCake å®ä¾‹ã€‚å·¥å‚æ–¹æ³•å°†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»å…·ä½“äº§å“ç±»ä¸­åˆ†ç¦»å‡ºæ¥ã€‚\n// Creator protocol CakeCreator { func createCake() -\u003e Cake func doSomethingForCake(cake: Cake) -\u003e Cake } // Product protocol Cake { func doWork() } // ConcreteCreator class MongoCakeCreator: CakeCreator { var cake: MongoCake? func createCake() -\u003e Cake { var cake = MongoCake() doSomethingForCake(cake: cake) return cake } func doSomethingForCake(cake: Cake) -\u003e Cake{ cake.doWork() cake.doWork() return cake } } // ConcreteCreator class ChocolateCakeCreator: CakeCreator { func createCake() -\u003e Cake { var cake = ChocolateCake() doSomethingForCake(cake: cake) return cake } func doSomethingForCake(cake: Cake) -\u003e Cake{ cake.doWork() return cake } } class MongoCake: Cake { func doWork() { print(\"Add some mongo\") } } class ChocolateCake: Cake { func doWork() { print(\"Add some chocolate\") } } // If we want to add a type of cake call \"PinapleCake\", just need to // make it conform to Cake and add a creator that conform to the CakeCreator for the \"PinapleCake\" let cakeOne = MongoCakeCreator().createCake() Abstract Factory Base on the factory method, add an abstract factory. We can call the same abstract factory method to create different modeâ€™s product. If we want to create another modeâ€™s product, we need to change the concrete factory.\nåŸºäºå·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæŠ½è±¡å·¥å‚åè®®ï¼Œå…¶å®ƒå…·ä½“çš„å·¥å‚æ¥å®ç°è¿™ä¸ªå·¥å‚åè®®ã€‚ä»è€Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨åŒä¸€ä¸ªæŠ½è±¡å·¥å‚æ–¹æ³•æ¥åˆ›å»ºä¸åŒæ¨¡å¼çš„ç›¸ä¼¼äº§å“ï¼ˆæ¯”å¦‚ WinButton å’Œ MacButtonï¼‰ã€‚å¦‚æœæƒ³è¦åˆ‡æ¢æ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦åˆ‡æ¢åˆ°å¦å¤–ä¸€ç§å…·ä½“çš„å·¥å‚å®ç°ã€‚\n// Abstract factory protocol GUIFactory { func createButton() -\u003e Button func createCheckBox() -\u003e CheckBox } // Concrete factory class WinGUIFactory: GUIFactory { func createButton() -\u003e Button { var btn = WinButton() return btn } func createCheckBox() -\u003e CheckBox { var box = WinCheckBox() return box } } // Concrete factory class MacGUIFactory: GUIFactory { func createButton() -\u003e Button { var btn = MacButton() return btn } func createCheckBox() -\u003e CheckBox { var box = MacCheckBox() return box } } // Abstract product protocol Button { func click() } // Abstract product protocol CheckBox { func render() } // Concrete product class WinButton: Button { func click() { print(\"Win click button\") } } // Concrete product class WinCheckBox: CheckBox { func render() { print(\"Here the win render checkBox\") } } // Concrete product class MacButton: Button { func click() { print(\"Mac click button\") } } // Concrete product class MacCheckBox: CheckBox { func render() { print(\"Here the mac render checkBox\") } } class App { var factory: GUIFactory init(factory: GUIFactory) { self.factory = factory } func someOperation() { var checkBox = factory.createCheckBox() checkBox.render() } } let factory = WinGUIFactory() let app = App(factory: factory) // The mode is choosen now, and the behavior in the app is specific. let button = app.factory.createButton(); button.click() app.someOperation() Builder Extracting the instanceâ€™s building code from the instanceâ€™s class, and put the code into a â€œBuilderâ€ object to do the build work. So we can build different complex instance by using different composition of the builder method. Besides, Add a â€œdirectorâ€ to manage the calling form client.\nå°†å¯¹è±¡çš„æ„é€ ä»£ç ä»å¯¹è±¡çš„äº§å“ç±»ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œå°†è¿™äº›ä»£ç æ”¾ç½®åœ¨ä¸€ä¸ªåä¸º â€œç”Ÿæˆå™¨â€ çš„ç‹¬ç«‹å¯¹è±¡ä¸­ã€‚Â æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å»ºé€ æ–¹æ³•ä¸­ä½¿ç”¨ä¸åŒçš„ç»„åˆï¼Œæ¥åˆ›å»ºä¸åŒçš„å¤æ‚å®ä¾‹ã€‚å¹¶ä¸”ï¼Œå¢åŠ ä¸€ä¸ª â€œæŒ‡æŒ¥è€…â€ æ¥ç®¡ç†é‚£äº›æ¥è‡ªå¤–ç•Œå®¢æˆ·å¯¹è°ƒç”¨ã€‚\n// Director class HouseDirector{ var builder: HouseBuilder init (builder: HouseBuilder) { self.builder = builder } func changeBuilder(bulider: HouseBuilder) { self.builder = bulider } // The function \"make\" define the house must built by some componets. func make(type: String) { builder.reset() if type == \"simple\" { builder.buildA() } else { builder.buildB() builder.buildC() } } } // Builder protocol HouseBuilder { func reset() func buildA() func buildB() func buildC() } class Builder1: HouseBuilder { private var result: Product1? func reset() { result = Product1() } func buildA() { } func buildB() { } func buildC() { } func getResult() -\u003e Product1? { return result } } class Builder2: HouseBuilder { private var result: Product2? func reset() { result = Product2() } func buildA() { } func buildB() { } func buildC() { } func getResult() -\u003e Product2? { return result } } class Product1 { } class Product2 { } let b = Builder1() let director = HouseDirector(builder: b) director.make(type: \"complex\") Singleton Singleton can solve two problem:\nKeep that one specific class have only one instance Provide a global access node for this instance Implementation:\nSet the default initializer as private to prevent other objects use it. Create a static func that will call the default initializer if the single instance is null, then this class will have this only one instance. å•ä¾‹æ¨¡å¼è§£å†³äº†å¯ä»¥è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š\nä¿è¯æŸä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ ä¸ºè¿™ä¸ªå®ä¾‹æä¾›å…¨å±€çš„è®¿é—®èŠ‚ç‚¹ å®ç°ï¼š\nå°†é»˜è®¤çš„æ„é€ å‡½æ•°è®¾ç½®ä¸ºç§æœ‰ï¼Œè®©å…¶å®ƒå¯¹è±¡æ— æ³•è®¿é—®ã€‚ æ–°å»ºä¸€ä¸ªé™æ€å‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥å•ä¾‹å¯¹è±¡ä¸ºç©ºï¼Œåˆ™è°ƒç”¨ç§æœ‰çš„æ„é€ å‡½æ•°æ¥åˆ›å»ºå®ä¾‹å¯¹è±¡ï¼Œå®ä¾‹åªè¢«åˆ›å»ºä¸€æ¬¡ã€‚ class FileAccess { private static var obj: FileAccess? = nil private init(){ } public static func getInstance() { if obj == nil { obj = FileAccess() } } } let firstAccess = FileAccess.getInstance() let secondAccess = FileAccess.getInstance() // These two access are reference to a same instance. Prototype When we want to clone the instance itself, it may create some dependencies between the client and the original class, it will make the code be more complex. So we use â€œprototypeâ€ to compound the clone operation into the original class itself. And the clone operation will be easily.\nå½“æˆ‘ä»¬æƒ³è¦å®Œå…¨å¤åˆ¶ä¸€ä¸ªå¯¹è±¡å®ƒæœ¬èº«æ—¶ï¼Œå¾ˆå¯èƒ½ä¼šåœ¨è°ƒç”¨è€…å’Œæºç±»ä¹‹é—´äº§ç”Ÿä¸€äº›å¤æ‚å½“è€¦åˆå…³ç³»ã€‚æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨â€œåŸå‹â€æ¨¡å¼ï¼Œå°†å¯¹è±¡å…‹éš†æ“ä½œæ•´åˆåœ¨å¯¹è±¡å½“æºç±»ä¹‹ä¸­ã€‚è¿™æ ·ä¸€æ¥ï¼Œå…‹éš†æ“ä½œç”±ç‰¹å®šçš„ç±»è‡ªèº«å†³å®šï¼Œè°ƒç”¨å˜å¾—ç®€æ´ã€‚\n// Prototype protocol StorePrototype{ func clone() -\u003e Store } // Concrete Prototype class Store: StorePrototype { var area: [Int] = [0, 0] init(store: StorePrototype) { if let s = store as? Store { self.area = s.area } } init() {} func clone() -\u003e Store { return Store(store: self) } } // Sub Concrete Prototype class BookStore: Store { var bookSelfCount = 0 init(bookStore: StorePrototype) { super.init(store: bookStore) if let s = bookStore as? BookStore { self.bookSelfCount = s.bookSelfCount } } override init() { super.init() } override func clone() -\u003e Store { return BookStore(bookStore: self) } } // Sub Concrete Prototype class FlowerStore: Store { var flowers = [\"Sun Flower\", \"Rose\", \"Lily\"] init(flowerStore: StorePrototype) { super.init(store: flowerStore) if let s = flowerStore as? FlowerStore { self.flowers = s.flowers } } override init() { super.init() } override func clone() -\u003e Store { return FlowerStore(flowerStore: self) } } let store = Store() let obj = FlowerStore() let copyStore = store.clone() let copyObj = obj.clone() // Now it did the deep copy. It copy the whole instance \"store\" to \"copyStore\", and copy the whole instace \"obj\" to copyObj. Structural Adapter A class called â€˜Aâ€™ needs to disguise as another class called â€˜Bâ€™, create a new adapter to extend the target class B and then insert the class A into the adapter, override the methods from the class B in the adapter. So we can use the adapter which has new features from A, just like we are using class B(The adapter extends from class B).\nç±» A æƒ³è¦é€‚é…ç±» Bï¼Œé¦–å…ˆä½¿ç”¨ä¸€ä¸ªé€‚é…å™¨ç»§æ‰¿ç±» B ï¼ŒæŠŠç±» A æ³¨å…¥é€‚é…å™¨ï¼Œåœ¨é€‚é…å™¨é‡Œé¢é‡å†™éœ€ è¦æ¨¡ä»¿çš„ç±» B çš„æ–¹æ³•ã€‚æœ€åï¼Œåœ¨éœ€è¦ç”¨ A æ›¿æ¢ B çš„åœ°æ–¹ï¼Œä¼ é€’ä¸€ä¸ªé€‚é…å™¨å³å¯ï¼Œå› ä¸ºå®ƒæ—¢å…·æœ‰ A çš„æ€§è´¨ï¼Œåˆå…·æœ‰ B çš„æ–¹æ³•ï¼Œå®ƒç»§æ‰¿è‡ª B ï¼Œå¯ä»¥å½“ä½œ B æ¥è°ƒç”¨ã€‚\nclass Bike { var name = \"deafult\" func go() { print(\"Bike Go\") } func addWheel() { print(\"Add wheel for\\(name)\") } } class WaterBike { var weight = 0 func floating() { print(\"The water bike floating on the water\") } } // now the water bike adapt the bike, inherit the target(Bike) that be disguised. class WaterBikeAdapter: Bike { var waterBike: WaterBike? init(waterBike: WaterBike) { self.waterBike = waterBike // inject the waterBike(which want to disguise as other) } override func go() { print(\"Now it's the water bike go\") } } func someThingGo(bike: Bike) { bike.go() } // This mode make the \"WaterBike\" to disguise as a \"Bike\" let waterBikeAdapter = WaterBikeAdapter(waterBike: WaterBike()) // The adapter has a waterBike and has the method of bike. someThingGo(bike: waterBikeAdapter) // Now it can use as a bike. Bridge It depart one class or some closing class into two independent layer, the abstract and the implementation. The concrete class A contains an abstract interface B, and this interface can be implement in different ways. The A relies on the interface B not the concrete class. We inject different concrete classï¼ˆhas implemented interface Bï¼‰ for A or subclass of A, so we can get an instance of A or subclass with different functionality.\næ¡¥æ¥æ¨¡å¼å°†ä¸€ä¸ªå¤§ç±»æˆ–è€…ä¸€ç³»åˆ—ç´§å¯†ç›¸å…³çš„ç±»æ‹†åˆ†ä¸ºæŠ½è±¡å’Œå®ç°ä¸¤ä¸ªç‹¬ç«‹çš„å±‚æ¬¡ç»“æ„ã€‚å®ä½“ç±» A åŒ…å«æœ‰æ¥å£ Bï¼Œè¿™ä¸ªæ¥å£å¯ä»¥é€šè¿‡ä¸åŒçš„æ–¹å¼æ¥å®ç°ã€‚å®ä½“ç±» A ä¾èµ–äºæ¥å£ B è€Œä¸æ˜¯å…·ä½“çš„ç±»ã€‚ æˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„å®ç°äº†æ¥å£ B çš„å®ä½“ç±»æ³¨å…¥åˆ° A ç±»å®ä½“æˆ–è€… Aç±»çš„å­ç±»çš„å®ä½“ä¸­ï¼Œä»è€Œå¯ä»¥å¾—åˆ°å…·æœ‰ä¸åŒåŠŸèƒ½çš„ A å®ä½“ æˆ–è€… A å­ç±»å®ä½“ã€‚\n// Abstract interface protocol Device { func isEnable() -\u003e Bool func enable() func disable() func getVolume() -\u003e Int func setVolume(_ volumn: Int) func getChannel() -\u003e Int func setChannel(_ channel: Int) } // Concrete class that contains the interface class Remote { var device: Device init(_ device: Device) { self.device = device } func togglePower() { if device.isEnable() { device.disable() } else { device.enable() } } func volumeUp() { device.setVolume(device.getVolume() + 1) } func voluomeDown() { device.setVolume(device.getVolume() - 1) } func channelUp() { device.setChannel(device.getChannel() + 1) } func channelDown() { device.setChannel(device.getChannel() - 1) } } // Sub class class AdvanceRemote: Remote { override init(_ device: Device) { super.init(device) } func mute() { device.setVolume(0) } } // Specific implementation of the interface class TV: Device { private var displaySize = (1080, 960) private var on: Bool = false private var volume = 0 private var channel = 0 func isEnable() -\u003e Bool { return on } func enable() { self.on = true } func disable() { self.on = false } func getVolume() -\u003e Int { return volume } func setVolume(_ volumn: Int) { self.volume = volumn } func getChannel() -\u003e Int { return channel } func setChannel(_ channel: Int) { self.channel = channel } } // Specific implementation of the interface class Radio: Device { private var on: Bool = false private var volume = 0 private var channel = 0 func isEnable() -\u003e Bool { return on } func enable() { on = true } func disable() { on = false } func getVolume() -\u003e Int { return volume } func setVolume(_ volumn: Int) { self.volume = volumn } func getChannel() -\u003e Int { return channel } func setChannel(_ channel: Int) { self.channel = channel } } let tv = TV() // create a TV let remote = AdvanceRemote(tv) // inject a concrete Device to the remote. remote.togglePower() remote.channelUp() remote.volumeUp() remote.mute() let radio = Radio() let remoteForRadio = Remote(radio) remoteForRadio.channelUp() remoteForRadio.togglePower() Composite We want to make the client using the Container or Leafs in a same calling way, so we set the leaf and the container that implement the same interface (Component). And the Container contains some children. In this way we create a model like tree, the client can treat every node similarly.\nä¸ºäº†ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä½¿ç”¨ç›¸åŒçš„æ–¹å¼è°ƒç”¨ â€œå®¹å™¨â€ å’Œ â€œå¶å­â€ï¼Œæˆ‘ä»¬è®©å®¹å™¨å’Œå¶å­éƒ½å»å®ç°åŒä¸€ä¸ªæ¥å£ â€œç»„ä»¶â€ã€‚å¹¶ä¸”å®¹å™¨ä¸­åŒ…å«æœ‰ä¸€äº›å­çš„å®¹å™¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç±»ä¼¼äºä¸€æ£µæ ‘çš„æ¨¡å‹ï¼Œå®¢æˆ·ç«¯å¯¹æ¯ä¸ªç»“ç‚¹ä½¿ç”¨ç›¸åŒçš„å¯¹å¾…æ–¹å¼ã€‚\n// interface protocol Component { func execute() } class Leaf: Component { func execute() { print(\"I'm leaf\") } } class SubLeaf: Leaf { override func execute() { print(\"I'm sub leaf\") } } // Composite class Containner:Component { private var children: [Component] = [] func add(c: Component) { children.append(c) } func remove(c: Component) { } func execute() { for item in children { item.execute() } } } // We treat the leaf and the containner as the same type of node. let leaf = Leaf() let leafTwo = Leaf() let subLeaf = SubLeaf() let c = Containner() c.add(c: leaf) c.add(c: leafTwo) let root = Containner() root.add(c: c) root.add(c: subLeaf) c.execute() root.execute() Decorator The components and decorators are departed, we can add new components and decorators freely. And we can make different compositions(with different decorations) to be different products.\nç»„ä»¶æ¨¡å—å’Œè£…é¥°å™¨æ˜¯åˆ†å¼€çš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°æ·»åŠ ç»„ä»¶å’Œè£…é¥°å™¨ã€‚æˆ‘ä»¬ä¹Ÿå¯ä½¿ç”¨ä¸åŒçš„ç»„åˆå½¢å¼ï¼ˆåŸºäºä¸åŒè£…é¥°æ–¹å¼ï¼‰ï¼Œæ¥å¾—åˆ°ä¸åŒçš„äº§å“ã€‚\n// Base interface between classes. protocol Component { var text: String? { get set} func execute() } // Concrete Component class Bike: Component { var text: String? func execute() { text = \"bike\" } } // Concrete Component class Moto: Component { var text: String? func execute() { text = \"moto\" } } // Base Decorator class BaseDecorator: Component { var text: String? private var c: Component func execute() { c.execute() if let t = c.text { text = \"\u003c\" + t + \"\u003e\" // Here the text is the property of the current concrete decorator. } else { text = \"\u003c\u003e\" } } func getText() -\u003e String { if let s = text { return s } else { return \"\" } } func setText(_ str: String?) { text = str } func getC() -\u003e Component { return c } // inject an instance init(_ c: Component) { self.c = c } } // Concrete Decorator class PaintDecorator: BaseDecorator { override func execute() { super.execute() extra() } func extra() { let s = getText() setText(\"(Paint)\\(s)(Paint)\") } } // Concrete Decorator class AttachTagDecorator: BaseDecorator { override func execute() { super.execute() extra() } func extra() { let s = getText() setText(\"(Tag)\\(s)(Tag)\") } } let a = Bike() let tag = AttachTagDecorator(a) let paint = PaintDecorator(tag) paint.execute() // (Paint)\u003c(Tag)(Tag)\u003e(Paint) print(paint.getText()) let b = Moto() let bpaint = PaintDecorator(b) let bTag = AttachTagDecorator(bpaint) bTag.execute() // (Tag)\u003c(Paint)(Paint)\u003e(Tag) print(bTag.getText()) Facade The sub-system has many objects and we want to decoupling them with the clientâ€™s calling, so we set a class Facade and use its instance to interact with the sub-system. The Facade just like an inter-media.\nä¸€ä¸ªå­ç³»ç»Ÿæœ‰è®¸å¤šå¯¹è±¡ï¼Œè€Œæˆ‘ä»¬æƒ³è¦å°†è¿™äº›å¯¹è±¡ä¸å®¢æˆ·ç«¯è°ƒç”¨è§£è€¦åˆï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®ä¸€ä¸ª â€œå¤–è§‚â€ ç±»ï¼Œä½¿ç”¨å¤–è§‚ç±»çš„å®ä¾‹æ¥ä¸å­ç³»ç»Ÿäº¤äº’ã€‚è¿™ä¸ªå¤–è§‚ç±»å®ä¾‹å°±åƒä¸€ä¸ªå¤„äºä¸­é—´çš„åª’ä»‹ã€‚\n// Sub-System objects class VideoFile { } class BitwiseNot { } class CvtColor { } class Transformer { } // Facade class VideoConverter { func convert() -\u003e File { var videoFile = VideoFile() var bitwiseNot = BitwiseNot() var cvtColor = CvtColor() var transformer = Transformer() var file = File() return file } } class File { } let converter = VideoConverter() var file = converter.convert() Flyweight The flyweight is to make the memory can load more objects. An object may have some properties that is repeating, and it take many memory space, we move these properties into another class(called Flyweight), and the original class just hold a reference of the Flyweight instance.\näº«å…ƒå¯ä»¥ä½¿å†…å­˜èƒ½åŠ è½½æ›´å¤šçš„å¯¹è±¡ã€‚ä¸€ä¸ªå¯¹è±¡å¯èƒ½ä¼šæ‹¥æœ‰ä¸€äº›é‡å¤çš„ã€å ç”¨ç©ºé—´å¤§çš„å±æ€§ï¼Œæˆ‘ä»¬å°†è¿™äº›å±æ€§ç§»åˆ°å¦å¤–çš„ä¸€ä¸ªç±»ä¸­ï¼ˆè¿™ä¸ªç±»ç§°ä¸ºäº«å…ƒï¼‰ï¼Œç„¶ååŸæ¥çš„ç±»å°±åªæ˜¯æŒæœ‰ä¸€ä¸ªäº«å…ƒå®ä¾‹çš„å¼•ç”¨ã€‚\n// Client class Game { var bullets: [Bullet] = [] var factory: Factory func creatBullet(_ count: Int) { for i in 0..","wordCount":"5473","inLanguage":"en","datePublished":"2022-07-11T18:27:35+08:00","dateModified":"2022-07-11T18:27:35+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://wowios.com/post/design-pattern/all-design-pattern/"},"publisher":{"@type":"Organization","name":"CodePaper","logo":{"@type":"ImageObject","url":"https://wowios.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wowios.com/ accesskey=h title="CodePaper (Alt + H)">CodePaper</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wowios.com/archive/ title=ğŸ“¦æ¡£æ¡ˆ><span>ğŸ“¦æ¡£æ¡ˆ</span></a></li><li><a href=https://wowios.com/categories/ title=ğŸ“–ç±»åˆ«><span>ğŸ“–ç±»åˆ«</span></a></li><li><a href=https://wowios.com/tags/ title=ğŸ·ï¸æ ‡ç­¾><span>ğŸ·ï¸æ ‡ç­¾</span></a></li><li><a href=https://wowios.com/search/ title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://wowios.com/about/ title=ğŸ§‘â€ğŸ’»å…³äºæˆ‘><span>ğŸ§‘â€ğŸ’»å…³äºæˆ‘</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wowios.com/>Home</a>&nbsp;Â»&nbsp;<a href=https://wowios.com/post/>Posts</a></div><h1 class="post-title entry-hint-parent">å„ç§è®¾è®¡æ¨¡å¼</h1><div class=post-meta><span title='2022-07-11 18:27:35 +0800 +0800'>July 11, 2022</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#creational aria-label=Creational>Creational</a><ul><li><a href=#factory-method aria-label="Factory Method">Factory Method</a></li><li><a href=#abstract-factory aria-label="Abstract Factory">Abstract Factory</a></li><li><a href=#builder aria-label=Builder>Builder</a></li><li><a href=#singleton aria-label=Singleton>Singleton</a></li><li><a href=#prototype aria-label=Prototype>Prototype</a></li></ul></li><li><a href=#structural aria-label=Structural>Structural</a><ul><li><a href=#adapter aria-label=Adapter>Adapter</a></li><li><a href=#bridge aria-label=Bridge>Bridge</a></li><li><a href=#composite aria-label=Composite>Composite</a></li><li><a href=#decorator aria-label=Decorator>Decorator</a></li><li><a href=#facade aria-label=Facade>Facade</a></li><li><a href=#flyweight aria-label=Flyweight>Flyweight</a></li><li><a href=#proxy aria-label=Proxy>Proxy</a></li><li><a href=#delegate aria-label=Delegate>Delegate</a></li></ul></li><li><a href=#behavioral aria-label=Behavioral>Behavioral</a><ul><li><a href=#chain-of-responsibility aria-label="Chain of Responsibility">Chain of Responsibility</a></li><li><a href=#command aria-label=Command>Command</a></li><li><a href=#iterator aria-label=Iterator>Iterator</a></li><li><a href=#mediator aria-label=Mediator>Mediator</a></li><li><a href=#memento aria-label=Memento>Memento</a></li><li><a href=#observer aria-label=Observer>Observer</a></li><li><a href=#state aria-label=State>State</a></li><li><a href=#strategy aria-label=Strategy>Strategy</a></li><li><a href=#template-method aria-label="Template Method">Template Method</a></li><li><a href=#visitor aria-label=Visitor>Visitor</a></li></ul></li><li><a href=#%e6%a8%a1%e5%bc%8f%e7%9a%84%e7%89%b9%e5%be%81%e4%b8%8e%e5%8c%ba%e5%88%ab aria-label=æ¨¡å¼çš„ç‰¹å¾ä¸åŒºåˆ«>æ¨¡å¼çš„ç‰¹å¾ä¸åŒºåˆ«</a><ul><li><a href=#%e7%bb%93%e6%9e%84%e5%9e%8b aria-label=ç»“æ„å‹>ç»“æ„å‹</a></li><li><a href=#%e8%a1%8c%e4%b8%ba%e5%9e%8b aria-label=è¡Œä¸ºå‹>è¡Œä¸ºå‹</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=creational>Creational<a hidden class=anchor aria-hidden=true href=#creational>#</a></h2><p>Object Created Pattern</p><h3 id=factory-method>Factory Method<a hidden class=anchor aria-hidden=true href=#factory-method>#</a></h3><p>Provide the method for creating an instance in the superclass, and allow the subclass to choose the type of the instance.</p><p>åœ¨çˆ¶ç±»ä¸­æä¾›åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚</p><p>å…·å¤‡çš„éƒ¨åˆ†ï¼šç”Ÿäº§è€…åè®®ã€äº§å“åè®®ï¼Œå¾€åå°±å¯ä»¥æ ¹æ®éœ€è¦æ¥æ‰©å±•æ¯ä¸€ç§äº§å“ã€‚</p><p><img alt=factory loading=lazy src=../imgs/factory.png></p><p>å…·ä½“çš„ç”Ÿäº§è€…æ¯”å¦‚ <code>MongoCakeCreator</code> çš„å­˜åœ¨æ˜¯ä¸ºäº†å®ç°ä¸äº§å“ç›¸å…³çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ›å»º <code>MongoCake</code> å®ä¾‹ã€‚å·¥å‚æ–¹æ³•å°†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»å…·ä½“äº§å“ç±»ä¸­åˆ†ç¦»å‡ºæ¥ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Creator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>CakeCreator</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createCake</span>() -&gt; Cake
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomethingForCake</span>(cake: Cake) -&gt; Cake
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Product</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Cake</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doWork</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ConcreteCreator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MongoCakeCreator</span>: CakeCreator {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> cake: MongoCake?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createCake</span>() -&gt; Cake {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> cake = MongoCake()
</span></span><span style=display:flex><span>            doSomethingForCake(cake: cake)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> cake
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomethingForCake</span>(cake: Cake) -&gt; Cake{
</span></span><span style=display:flex><span>            cake.doWork()
</span></span><span style=display:flex><span>            cake.doWork()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> cake
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ConcreteCreator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChocolateCakeCreator</span>: CakeCreator {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createCake</span>() -&gt; Cake {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> cake = ChocolateCake()
</span></span><span style=display:flex><span>            doSomethingForCake(cake: cake)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> cake
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doSomethingForCake</span>(cake: Cake) -&gt; Cake{
</span></span><span style=display:flex><span>            cake.doWork()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> cake
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MongoCake</span>: Cake {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doWork</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add some mongo&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChocolateCake</span>: Cake {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>doWork</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add some chocolate&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// If we want to add a type of cake call &#34;PinapleCake&#34;, just need to </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// make it conform to Cake and add a creator that conform to the CakeCreator for the &#34;PinapleCake&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> cakeOne = MongoCakeCreator().createCake()
</span></span></code></pre></div><h3 id=abstract-factory>Abstract Factory<a hidden class=anchor aria-hidden=true href=#abstract-factory>#</a></h3><p>Base on the factory method, add an abstract factory. We can call the same abstract factory method to create different modeâ€™s product. If we want to create another modeâ€™s product, we need to change the concrete factory.</p><p>åŸºäºå·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæŠ½è±¡å·¥å‚åè®®ï¼Œå…¶å®ƒå…·ä½“çš„å·¥å‚æ¥å®ç°è¿™ä¸ªå·¥å‚åè®®ã€‚ä»è€Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨åŒä¸€ä¸ªæŠ½è±¡å·¥å‚æ–¹æ³•æ¥åˆ›å»ºä¸åŒæ¨¡å¼çš„ç›¸ä¼¼äº§å“ï¼ˆæ¯”å¦‚ WinButton å’Œ MacButtonï¼‰ã€‚å¦‚æœæƒ³è¦åˆ‡æ¢æ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦åˆ‡æ¢åˆ°å¦å¤–ä¸€ç§å…·ä½“çš„å·¥å‚å®ç°ã€‚</p><p><img alt=abstractFactory loading=lazy src=../imgs/abstractFactory.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Abstract factory</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>GUIFactory</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createButton</span>() -&gt; Button
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createCheckBox</span>() -&gt; CheckBox
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete factory</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WinGUIFactory</span>: GUIFactory {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createButton</span>() -&gt; Button {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> btn = WinButton()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> btn
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createCheckBox</span>() -&gt; CheckBox {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> box = WinCheckBox()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> box
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete factory</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MacGUIFactory</span>: GUIFactory {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createButton</span>() -&gt; Button {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> btn = MacButton()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> btn
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createCheckBox</span>() -&gt; CheckBox {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> box = MacCheckBox()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> box
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Abstract product</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Button</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>click</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Abstract product</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>CheckBox</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>render</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete product</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WinButton</span>: Button {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>click</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Win click button&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete product</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WinCheckBox</span>: CheckBox {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>render</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Here the win render checkBox&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete product</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MacButton</span>: Button {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>click</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Mac click button&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete product</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MacCheckBox</span>: CheckBox {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>render</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Here the mac render checkBox&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>App</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> factory: GUIFactory
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(factory: GUIFactory) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.factory = factory
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>someOperation</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> checkBox = factory.createCheckBox()
</span></span><span style=display:flex><span>            checkBox.render()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> factory = WinGUIFactory()           
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> app = App(factory: factory)         <span style=color:#75715e>// The mode is choosen now, and the behavior in the app is specific.</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> button = app.factory.createButton();
</span></span><span style=display:flex><span>    button.click()
</span></span><span style=display:flex><span>    app.someOperation()
</span></span></code></pre></div><h3 id=builder>Builder<a hidden class=anchor aria-hidden=true href=#builder>#</a></h3><p>Extracting the instanceâ€™s building code from the instanceâ€™s class, and put the code into a â€œBuilderâ€ object to do the build work. So we can build different complex instance by using different composition of the builder method. Besides, Add a â€œdirectorâ€ to manage the calling form client.</p><p>å°†å¯¹è±¡çš„æ„é€ ä»£ç ä»å¯¹è±¡çš„äº§å“ç±»ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œå°†è¿™äº›ä»£ç æ”¾ç½®åœ¨ä¸€ä¸ªåä¸º â€œç”Ÿæˆå™¨â€ çš„ç‹¬ç«‹å¯¹è±¡ä¸­ã€‚Â æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å»ºé€ æ–¹æ³•ä¸­ä½¿ç”¨ä¸åŒçš„ç»„åˆï¼Œæ¥åˆ›å»ºä¸åŒçš„å¤æ‚å®ä¾‹ã€‚å¹¶ä¸”ï¼Œå¢åŠ ä¸€ä¸ª â€œæŒ‡æŒ¥è€…â€ æ¥ç®¡ç†é‚£äº›æ¥è‡ªå¤–ç•Œå®¢æˆ·å¯¹è°ƒç”¨ã€‚</p><p><img alt=builder loading=lazy src=../imgs/builder.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Director</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HouseDirector</span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> builder: HouseBuilder
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span> (builder: HouseBuilder) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.builder = builder
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>changeBuilder</span>(bulider: HouseBuilder) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.builder = bulider
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// The function &#34;make&#34; define the house must built by some componets. </span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>make</span>(type: String) {
</span></span><span style=display:flex><span>            builder.reset()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> type == <span style=color:#e6db74>&#34;simple&#34;</span> {
</span></span><span style=display:flex><span>                builder.buildA()
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                builder.buildB()
</span></span><span style=display:flex><span>                builder.buildC()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Builder</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>HouseBuilder</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>reset</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildA</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildB</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildC</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Builder1</span>: HouseBuilder {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> result: Product1?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>reset</span>() {
</span></span><span style=display:flex><span>            result = Product1()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildA</span>() {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildB</span>() {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildC</span>() {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getResult</span>() -&gt; Product1? {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Builder2</span>: HouseBuilder {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> result: Product2?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>reset</span>() {
</span></span><span style=display:flex><span>            result = Product2()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildA</span>() {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildB</span>() {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>buildC</span>() {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getResult</span>() -&gt; Product2? {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Product1</span> {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Product2</span> {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> b = Builder1()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> director = HouseDirector(builder: b)
</span></span><span style=display:flex><span>    director.make(type: <span style=color:#e6db74>&#34;complex&#34;</span>)
</span></span></code></pre></div><h3 id=singleton>Singleton<a hidden class=anchor aria-hidden=true href=#singleton>#</a></h3><p>Singleton can solve two problem:</p><ul><li>Keep that one specific class have only one instance</li><li>Provide a global access node for this instance</li></ul><p>Implementation:</p><ul><li>Set the default initializer as private to prevent other objects use it.</li><li>Create a static func that will call the default initializer if the single instance is null, then this class will have this only one instance.</li></ul><p>å•ä¾‹æ¨¡å¼è§£å†³äº†å¯ä»¥è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>ä¿è¯æŸä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹</li><li>ä¸ºè¿™ä¸ªå®ä¾‹æä¾›å…¨å±€çš„è®¿é—®èŠ‚ç‚¹</li></ul><p>å®ç°ï¼š</p><ul><li>å°†é»˜è®¤çš„æ„é€ å‡½æ•°è®¾ç½®ä¸ºç§æœ‰ï¼Œè®©å…¶å®ƒå¯¹è±¡æ— æ³•è®¿é—®ã€‚</li><li>æ–°å»ºä¸€ä¸ªé™æ€å‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥å•ä¾‹å¯¹è±¡ä¸ºç©ºï¼Œåˆ™è°ƒç”¨ç§æœ‰çš„æ„é€ å‡½æ•°æ¥åˆ›å»ºå®ä¾‹å¯¹è±¡ï¼Œå®ä¾‹åªè¢«åˆ›å»ºä¸€æ¬¡ã€‚</li></ul><p><img alt=singleton loading=lazy src=../imgs/signleton.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>        <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FileAccess</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>var</span> obj: FileAccess? = <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>init</span>(){
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getInstance</span>() {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> obj == <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>                    obj = FileAccess()
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> firstAccess = FileAccess.getInstance()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> secondAccess = FileAccess.getInstance()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// These two access are reference to a same instance.</span>
</span></span></code></pre></div><h3 id=prototype>Prototype<a hidden class=anchor aria-hidden=true href=#prototype>#</a></h3><p>When we want to clone the instance itself, it may create some dependencies between the client and the original class, it will make the code be more complex. So we use â€œprototypeâ€ to <strong>compound the clone operation into the original class itself</strong>. And the clone operation will be easily.</p><p>å½“æˆ‘ä»¬æƒ³è¦å®Œå…¨å¤åˆ¶ä¸€ä¸ªå¯¹è±¡å®ƒæœ¬èº«æ—¶ï¼Œå¾ˆå¯èƒ½ä¼šåœ¨è°ƒç”¨è€…å’Œæºç±»ä¹‹é—´äº§ç”Ÿä¸€äº›å¤æ‚å½“è€¦åˆå…³ç³»ã€‚æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨â€œåŸå‹â€æ¨¡å¼ï¼Œå°†å¯¹è±¡å…‹éš†æ“ä½œæ•´åˆåœ¨å¯¹è±¡å½“æºç±»ä¹‹ä¸­ã€‚è¿™æ ·ä¸€æ¥ï¼Œå…‹éš†æ“ä½œç”±ç‰¹å®šçš„ç±»è‡ªèº«å†³å®šï¼Œè°ƒç”¨å˜å¾—ç®€æ´ã€‚</p><p><img alt=prototype loading=lazy src=../imgs/prototype.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Prototype</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>StorePrototype</span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>clone</span>() -&gt; Store
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete Prototype</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Store</span>: StorePrototype {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> area: [Int] = [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(store: StorePrototype) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = store <span style=color:#66d9ef>as</span>? Store {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>self</span>.area = s.area
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>() {}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>clone</span>() -&gt; Store {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Store(store: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Sub Concrete Prototype</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BookStore</span>: Store {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> bookSelfCount = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(bookStore: StorePrototype) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>(store: bookStore)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = bookStore <span style=color:#66d9ef>as</span>? BookStore {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>self</span>.bookSelfCount = s.bookSelfCount
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>init</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>clone</span>() -&gt; Store {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> BookStore(bookStore: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Sub Concrete Prototype</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FlowerStore</span>: Store {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> flowers = [<span style=color:#e6db74>&#34;Sun Flower&#34;</span>, <span style=color:#e6db74>&#34;Rose&#34;</span>, <span style=color:#e6db74>&#34;Lily&#34;</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(flowerStore: StorePrototype) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>(store: flowerStore)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = flowerStore <span style=color:#66d9ef>as</span>? FlowerStore {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>self</span>.flowers = s.flowers
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>init</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>clone</span>() -&gt; Store {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> FlowerStore(flowerStore: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> store = Store()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> obj = FlowerStore()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> copyStore = store.clone()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> copyObj = obj.clone()        
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Now it did the deep copy. It copy the whole instance &#34;store&#34; to &#34;copyStore&#34;, and copy the whole instace &#34;obj&#34; to copyObj.</span>
</span></span></code></pre></div><h2 id=structural>Structural<a hidden class=anchor aria-hidden=true href=#structural>#</a></h2><h3 id=adapter>Adapter<a hidden class=anchor aria-hidden=true href=#adapter>#</a></h3><p>A class called â€˜Aâ€™ needs to disguise as another class called â€˜Bâ€™, create a new adapter to extend the target class B and then insert the class A into the adapter, override the methods from the class B in the adapter. So we can use the adapter which has new features from A, just like we are using class B(The adapter extends from class B).</p><p>ç±» A æƒ³è¦é€‚é…ç±» Bï¼Œé¦–å…ˆä½¿ç”¨ä¸€ä¸ªé€‚é…å™¨ç»§æ‰¿ç±» B ï¼ŒæŠŠç±» A æ³¨å…¥é€‚é…å™¨ï¼Œåœ¨é€‚é…å™¨é‡Œé¢é‡å†™éœ€ è¦æ¨¡ä»¿çš„ç±» B çš„æ–¹æ³•ã€‚æœ€åï¼Œåœ¨éœ€è¦ç”¨ A æ›¿æ¢ B çš„åœ°æ–¹ï¼Œä¼ é€’ä¸€ä¸ªé€‚é…å™¨å³å¯ï¼Œå› ä¸ºå®ƒæ—¢å…·æœ‰ A çš„æ€§è´¨ï¼Œåˆå…·æœ‰ B çš„æ–¹æ³•ï¼Œå®ƒç»§æ‰¿è‡ª B ï¼Œå¯ä»¥å½“ä½œ B æ¥è°ƒç”¨ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Bike</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> name = <span style=color:#e6db74>&#34;deafult&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>go</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Bike Go&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>addWheel</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add wheel for</span><span style=color:#e6db74>\(</span>name<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WaterBike</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> weight = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>floating</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;The water bike floating on the water&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// now the water bike adapt the bike, inherit the target(Bike) that be disguised.</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WaterBikeAdapter</span>: Bike {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> waterBike: WaterBike?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(waterBike: WaterBike) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.waterBike = waterBike  <span style=color:#75715e>// inject the waterBike(which want to disguise as other)</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>go</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Now it&#39;s the water bike go&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>someThingGo</span>(bike: Bike) {
</span></span><span style=display:flex><span>        bike.go()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// This mode make the &#34;WaterBike&#34; to disguise as a &#34;Bike&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> waterBikeAdapter = WaterBikeAdapter(waterBike: WaterBike()) <span style=color:#75715e>// The adapter has a waterBike and  has the method of bike.</span>
</span></span><span style=display:flex><span>    someThingGo(bike: waterBikeAdapter) <span style=color:#75715e>// Now it can use as a bike.</span>
</span></span></code></pre></div><h3 id=bridge>Bridge<a hidden class=anchor aria-hidden=true href=#bridge>#</a></h3><p>It depart one class or some closing class into two independent layer, the abstract and the implementation. The concrete class A contains an abstract interface B, and <strong>this interface can be implement in different ways</strong>. The A relies on the interface B not the concrete class. We inject different concrete classï¼ˆhas implemented interface Bï¼‰ for A or subclass of A, so we can get an instance of A or subclass with different functionality.</p><p>æ¡¥æ¥æ¨¡å¼å°†ä¸€ä¸ªå¤§ç±»æˆ–è€…ä¸€ç³»åˆ—ç´§å¯†ç›¸å…³çš„ç±»æ‹†åˆ†ä¸º<strong>æŠ½è±¡</strong>å’Œ<strong>å®ç°</strong>ä¸¤ä¸ªç‹¬ç«‹çš„å±‚æ¬¡ç»“æ„ã€‚å®ä½“ç±» A åŒ…å«æœ‰æ¥å£ Bï¼Œè¿™ä¸ªæ¥å£å¯ä»¥é€šè¿‡ä¸åŒçš„æ–¹å¼æ¥å®ç°ã€‚å®ä½“ç±» A ä¾èµ–äºæ¥å£ B è€Œä¸æ˜¯å…·ä½“çš„ç±»ã€‚ æˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„å®ç°äº†æ¥å£ B çš„å®ä½“ç±»æ³¨å…¥åˆ° A ç±»å®ä½“æˆ–è€… Aç±»çš„å­ç±»çš„å®ä½“ä¸­ï¼Œä»è€Œå¯ä»¥å¾—åˆ°å…·æœ‰ä¸åŒåŠŸèƒ½çš„ A å®ä½“ æˆ–è€… A å­ç±»å®ä½“ã€‚</p><p><img alt=bridge loading=lazy src=../imgs/bridge.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Abstract interface</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Device</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>isEnable</span>() -&gt; Bool
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>enable</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>disable</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getVolume</span>() -&gt; Int
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setVolume</span>(<span style=color:#66d9ef>_</span> volumn: Int)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getChannel</span>() -&gt; Int
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setChannel</span>(<span style=color:#66d9ef>_</span> channel: Int)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete class that contains the interface</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Remote</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> device: Device
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> device: Device) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.device = device
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>togglePower</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> device.isEnable() {
</span></span><span style=display:flex><span>                device.disable()
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                device.enable()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>volumeUp</span>() {
</span></span><span style=display:flex><span>            device.setVolume(device.getVolume() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>voluomeDown</span>() {
</span></span><span style=display:flex><span>            device.setVolume(device.getVolume() <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>channelUp</span>() {
</span></span><span style=display:flex><span>            device.setChannel(device.getChannel() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>channelDown</span>() {
</span></span><span style=display:flex><span>            device.setChannel(device.getChannel() <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Sub class</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AdvanceRemote</span>: Remote {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> device: Device) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>(device)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>mute</span>() {
</span></span><span style=display:flex><span>            device.setVolume(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Specific implementation of the interface</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TV</span>: Device {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> displaySize = (<span style=color:#ae81ff>1080</span>, <span style=color:#ae81ff>960</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> on: Bool = <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> volume = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> channel = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>isEnable</span>() -&gt; Bool {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> on
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>enable</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.on = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>disable</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.on = <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getVolume</span>() -&gt; Int {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> volume
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setVolume</span>(<span style=color:#66d9ef>_</span> volumn: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.volume = volumn
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getChannel</span>() -&gt; Int {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> channel
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setChannel</span>(<span style=color:#66d9ef>_</span> channel: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.channel = channel
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Specific implementation of the interface</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Radio</span>: Device {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> on: Bool = <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> volume = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> channel = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>isEnable</span>() -&gt; Bool {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> on
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>enable</span>() {
</span></span><span style=display:flex><span>            on = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>disable</span>() {
</span></span><span style=display:flex><span>            on = <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getVolume</span>() -&gt; Int {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> volume
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setVolume</span>(<span style=color:#66d9ef>_</span> volumn: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.volume = volumn
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getChannel</span>() -&gt; Int {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> channel
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setChannel</span>(<span style=color:#66d9ef>_</span> channel: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.channel = channel
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> tv = TV()                     <span style=color:#75715e>// create a TV</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> remote = AdvanceRemote(tv)    <span style=color:#75715e>// inject a concrete Device to the remote.</span>
</span></span><span style=display:flex><span>    remote.togglePower()
</span></span><span style=display:flex><span>    remote.channelUp()
</span></span><span style=display:flex><span>    remote.volumeUp()
</span></span><span style=display:flex><span>    remote.mute()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> radio = Radio()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> remoteForRadio = Remote(radio)
</span></span><span style=display:flex><span>    remoteForRadio.channelUp()
</span></span><span style=display:flex><span>    remoteForRadio.togglePower()
</span></span></code></pre></div><h3 id=composite>Composite<a hidden class=anchor aria-hidden=true href=#composite>#</a></h3><p>We want to make the client using the Container or Leafs in a same calling way, so we set the leaf and the container that implement the same interface (Component). And the Container contains some children. In this way we create a model like tree, the client can treat every node similarly.</p><p>ä¸ºäº†ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä½¿ç”¨ç›¸åŒçš„æ–¹å¼è°ƒç”¨ â€œå®¹å™¨â€ å’Œ â€œå¶å­â€ï¼Œæˆ‘ä»¬è®©å®¹å™¨å’Œå¶å­éƒ½å»å®ç°åŒä¸€ä¸ªæ¥å£ â€œç»„ä»¶â€ã€‚å¹¶ä¸”å®¹å™¨ä¸­åŒ…å«æœ‰ä¸€äº›å­çš„å®¹å™¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç±»ä¼¼äºä¸€æ£µæ ‘çš„æ¨¡å‹ï¼Œå®¢æˆ·ç«¯å¯¹æ¯ä¸ªç»“ç‚¹ä½¿ç”¨ç›¸åŒçš„å¯¹å¾…æ–¹å¼ã€‚</p><p><img alt=composite loading=lazy src=../imgs/command.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// interface</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Component</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Leaf</span>: Component {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;I&#39;m leaf&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SubLeaf</span>: Leaf {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;I&#39;m sub leaf&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Composite</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Containner</span>:Component {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> children: [Component] = []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>add</span>(c: Component) {
</span></span><span style=display:flex><span>            children.append(c)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>remove</span>(c: Component) {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> item <span style=color:#66d9ef>in</span> children {
</span></span><span style=display:flex><span>                item.execute()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// We treat the leaf and the containner as the same type of node.</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> leaf = Leaf()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> leafTwo = Leaf()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> subLeaf = SubLeaf()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> c = Containner()
</span></span><span style=display:flex><span>    c.add(c: leaf)
</span></span><span style=display:flex><span>    c.add(c: leafTwo)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> root = Containner()
</span></span><span style=display:flex><span>    root.add(c: c)
</span></span><span style=display:flex><span>    root.add(c: subLeaf)
</span></span><span style=display:flex><span>    c.execute()
</span></span><span style=display:flex><span>    root.execute()
</span></span></code></pre></div><h3 id=decorator>Decorator<a hidden class=anchor aria-hidden=true href=#decorator>#</a></h3><p>The components and decorators are departed, we can add new components and decorators freely. And we can make different compositions(with different decorations) to be different products.</p><p>ç»„ä»¶æ¨¡å—å’Œè£…é¥°å™¨æ˜¯åˆ†å¼€çš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°æ·»åŠ ç»„ä»¶å’Œè£…é¥°å™¨ã€‚æˆ‘ä»¬ä¹Ÿå¯ä½¿ç”¨ä¸åŒçš„ç»„åˆå½¢å¼ï¼ˆåŸºäºä¸åŒè£…é¥°æ–¹å¼ï¼‰ï¼Œæ¥å¾—åˆ°ä¸åŒçš„äº§å“ã€‚</p><p><img alt=decorator loading=lazy src=../imgs/decorator.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Base interface between classes.</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Component</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> text: String? { <span style=color:#66d9ef>get</span> <span style=color:#66d9ef>set</span>}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete Component</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Bike</span>: Component {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> text: String?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>            text = <span style=color:#e6db74>&#34;bike&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete Component</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Moto</span>: Component {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> text: String?
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>            text = <span style=color:#e6db74>&#34;moto&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Base Decorator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BaseDecorator</span>: Component {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> text: String?
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> c: Component
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>            c.execute()
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> t = c.text {
</span></span><span style=display:flex><span>                text = <span style=color:#e6db74>&#34;&lt;&#34;</span> <span style=color:#f92672>+</span> t <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&gt;&#34;</span>   <span style=color:#75715e>// Here the text is the property of the current concrete decorator.</span>
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                text = <span style=color:#e6db74>&#34;&lt;&gt;&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }    
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getText</span>() -&gt; String {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = text {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> s
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setText</span>(<span style=color:#66d9ef>_</span> str: String?) {
</span></span><span style=display:flex><span>            text = str
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getC</span>() -&gt; Component {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> c
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// inject an instance</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> c: Component) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.c = c
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete Decorator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PaintDecorator</span>: BaseDecorator {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.execute()
</span></span><span style=display:flex><span>            extra()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>extra</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> s = getText()
</span></span><span style=display:flex><span>            setText(<span style=color:#e6db74>&#34;(Paint)</span><span style=color:#e6db74>\(</span>s<span style=color:#e6db74>)</span><span style=color:#e6db74>(Paint)&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete Decorator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AttachTagDecorator</span>: BaseDecorator {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.execute()
</span></span><span style=display:flex><span>            extra()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>extra</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> s = getText()
</span></span><span style=display:flex><span>            setText(<span style=color:#e6db74>&#34;(Tag)</span><span style=color:#e6db74>\(</span>s<span style=color:#e6db74>)</span><span style=color:#e6db74>(Tag)&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> a = Bike()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> tag = AttachTagDecorator(a)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> paint = PaintDecorator(tag)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    paint.execute()                <span style=color:#75715e>// (Paint)&lt;(Tag)&lt;bike&gt;(Tag)&gt;(Paint)</span>
</span></span><span style=display:flex><span>    print(paint.getText())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> b = Moto()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> bpaint = PaintDecorator(b)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> bTag = AttachTagDecorator(bpaint)
</span></span><span style=display:flex><span>    bTag.execute()                <span style=color:#75715e>// (Tag)&lt;(Paint)&lt;moto&gt;(Paint)&gt;(Tag)</span>
</span></span><span style=display:flex><span>    print(bTag.getText())
</span></span><span style=display:flex><span>    
</span></span></code></pre></div><h3 id=facade>Facade<a hidden class=anchor aria-hidden=true href=#facade>#</a></h3><p>The sub-system has many objects and we want to decoupling them with the clientâ€™s calling, so we set a class <code>Facade</code> and use its instance to interact with the sub-system. The <code>Facade</code> just like an inter-media.</p><p>Â ä¸€ä¸ªå­ç³»ç»Ÿæœ‰è®¸å¤šå¯¹è±¡ï¼Œè€Œæˆ‘ä»¬æƒ³è¦å°†è¿™äº›å¯¹è±¡ä¸å®¢æˆ·ç«¯è°ƒç”¨è§£è€¦åˆï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®ä¸€ä¸ª â€œå¤–è§‚â€ ç±»ï¼Œä½¿ç”¨å¤–è§‚ç±»çš„å®ä¾‹æ¥ä¸å­ç³»ç»Ÿäº¤äº’ã€‚è¿™ä¸ªå¤–è§‚ç±»å®ä¾‹å°±åƒä¸€ä¸ªå¤„äºä¸­é—´çš„åª’ä»‹ã€‚</p><p><img alt=facade loading=lazy src=../imgs/facade.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Sub-System objects</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>VideoFile</span> {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BitwiseNot</span> {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CvtColor</span> {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Transformer</span> {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Facade</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>VideoConverter</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>convert</span>() -&gt; File {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> videoFile = VideoFile()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> bitwiseNot = BitwiseNot()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> cvtColor = CvtColor()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> transformer = Transformer()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> file = File()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> file
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>File</span> {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> converter = VideoConverter()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> file = converter.convert()
</span></span></code></pre></div><h3 id=flyweight>Flyweight<a hidden class=anchor aria-hidden=true href=#flyweight>#</a></h3><p>The flyweight is to make the memory can load more objects. An object may have some properties that is repeating, and it take many memory space, we move these properties into another class(called Flyweight), and the original class just hold a reference of the Flyweight instance.</p><p>äº«å…ƒå¯ä»¥ä½¿å†…å­˜èƒ½åŠ è½½æ›´å¤šçš„å¯¹è±¡ã€‚ä¸€ä¸ªå¯¹è±¡å¯èƒ½ä¼šæ‹¥æœ‰ä¸€äº›é‡å¤çš„ã€å ç”¨ç©ºé—´å¤§çš„å±æ€§ï¼Œæˆ‘ä»¬å°†è¿™äº›å±æ€§ç§»åˆ°å¦å¤–çš„ä¸€ä¸ªç±»ä¸­ï¼ˆè¿™ä¸ªç±»ç§°ä¸ºäº«å…ƒï¼‰ï¼Œç„¶ååŸæ¥çš„ç±»å°±åªæ˜¯æŒæœ‰ä¸€ä¸ªäº«å…ƒå®ä¾‹çš„å¼•ç”¨ã€‚</p><p><img alt=flyweight loading=lazy src=../imgs/flyweight.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Client</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Game</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> bullets: [Bullet] = []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> factory: Factory
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>creatBullet</span>(<span style=color:#66d9ef>_</span> count: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> i <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>0.</span>.&lt;count {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> b = Bullet(id: i, position: [Int.random(<span style=color:#66d9ef>in</span>: <span style=color:#ae81ff>0.</span>..<span style=color:#ae81ff>20</span>), Int.random(<span style=color:#66d9ef>in</span>: <span style=color:#ae81ff>0.</span>..<span style=color:#ae81ff>20</span>)], paint: factory.getBulletPaint(sign: BulletPaint.sign))
</span></span><span style=display:flex><span>                bullets.append(b)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>() {
</span></span><span style=display:flex><span>            factory = Factory()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Context</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Bullet</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> id: Int
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> position: [Int] = [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> paint: BulletPaint
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(id: Int, position: [Int], paint: BulletPaint) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.id = id
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.position = position
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.paint = paint
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Flyweight</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BulletPaint</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> picture: String?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>var</span> sign = <span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>changePicture</span>(picture: String) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.picture = picture
</span></span><span style=display:flex><span>            BulletPaint.sign <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Flyweight Factory</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Factory</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> stuff: [BulletPaint] = []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getBulletPaint</span>(sign: Int) -&gt; BulletPaint {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> stuff.count <span style=color:#f92672>&lt;=</span> sign <span style=color:#f92672>||</span> stuff[sign] == <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> paint = BulletPaint()
</span></span><span style=display:flex><span>                stuff.append(paint)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> paint
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> stuff[sign]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> game = Game()
</span></span><span style=display:flex><span>    game.creatBullet(<span style=color:#ae81ff>100</span>)
</span></span></code></pre></div><h3 id=proxy>Proxy<a hidden class=anchor aria-hidden=true href=#proxy>#</a></h3><p>A class <code>Proxy</code> and a class <code>Service</code> both conform to the same protocol <code>ServiceInterface</code>, and <code>Proxy</code> want to give some of its method to done by <code>Service</code>, so <code>Proxy</code> just keep a reference of <code>Service</code> and call the <code>Service</code> when <code>Proxy</code> it want to solve some problem.</p><p>ä¸€ä¸ªåä¸º â€œä»£ç†â€ çš„ç±»å’Œä¸€ä¸ªåä¸º â€œæœåŠ¡â€ çš„ç±»éƒ½éµå®ˆåŒä¸€ä¸ªåä¸º â€œæœåŠ¡æ¥å£â€ çš„åè®®ï¼Œ ç„¶åä»£ç†æƒ³è¦æŠŠå®ƒçš„ä¸€äº›æ–¹æ³•äº¤ç»™æœåŠ¡å»åšï¼Œè¿›è€Œä»£ç†åªæ˜¯æŒæœ‰æœåŠ¡çš„ä¸€ä¸ªå¼•ç”¨ï¼Œç„¶ååœ¨éœ€è¦è§£å†³é—®é¢˜çš„æ—¶å€™ï¼Œè°ƒç”¨ä»£ç†æ¥è§£å†³ã€‚</p><p><img alt=proxy loading=lazy src=../imgs/proxy.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Service Interface</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Work</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>manageStuff</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>dispatchSalary</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Proxy</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Boss</span>: Work {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> manager: Manager?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(manager: Manager) {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>manageStuff</span>() {
</span></span><span style=display:flex><span>            manager?.manageStuff()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>dispatchSalary</span>() {
</span></span><span style=display:flex><span>            manager?.dispatchSalary()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Service</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Manager</span>: Work {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>manageStuff</span>() {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>dispatchSalary</span>() {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> manager = Manager()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> boss = Boss(manager: manager)
</span></span><span style=display:flex><span>    boss.dispatchSalary()   <span style=color:#75715e>// In fact, it&#39;s the manager whom dispatch the salary.</span>
</span></span></code></pre></div><h3 id=delegate>Delegate<a hidden class=anchor aria-hidden=true href=#delegate>#</a></h3><p>We move some detail method from class A to class B (delegation), and the B can do some detail by the inputed Aâ€™s reference.</p><p>æˆ‘ä»¬ A ä¸­å®ç°å…·ä½“åŠŸèƒ½çš„æ–¹æ³•ç§»åŠ¨åˆ° B ä¸­ï¼ŒB ä¸ºå—å§”æ‰˜å¯¹è±¡ï¼ŒB ä¸­çš„æ–¹æ³•éƒ½æ˜¯éœ€è¦è¾“å…¥ä¸€ä¸ª A çš„å¼•ç”¨ï¼Œä»è€Œæ‰èƒ½è®© B æ›¿ A åšä¸€äº›å…·ä½“ä¸”å¤æ‚çš„æ“ä½œã€‚ç›¸å½“äº A æŠŠå¤æ‚çš„æ“ä½œå§”æ´¾ç»™ B æ¥å®Œæˆã€‚</p><p>Class <code>Game</code> has a <code>GameDelegation</code> in it. Then input the <code>Game</code> instance to the <code>Delegation</code> instance, and the delegation can do some detailed work that may be previously done by the <code>Game</code> instance. So itâ€˜s called delegate model.</p><p>ç±» <code>game</code> æ‹¥æœ‰ä¸€ä¸ª <code>GameDelegation</code> . æ¥ç€è¾“å…¥ <code>Game</code> å®ä¾‹åˆ° <code>Delegation</code> çš„å®ä¾‹ï¼Œè¿™ä¸ªå§”æ´¾è€…å¯ä»¥åšä¸€äº›æœ¬æ¥åº”è¯¥ç”± <code>Game</code> çš„å®ä¾‹æ¥å®Œæˆçš„ç»†èŠ‚çš„äº‹æƒ…ã€‚è¿™æ ·çš„æ¨¡å¼ç§°ä¸ºå§”æ´¾æ¨¡å¼ã€‚</p><p><img alt=delegate loading=lazy src=../imgs/delegation.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Delegation</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Delegation</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>gameDidStart</span>(<span style=color:#66d9ef>_</span> game: Game)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>game</span>(<span style=color:#66d9ef>_</span> game: Game)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>gameDidEnd</span>(<span style=color:#66d9ef>_</span> game: Game)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Game</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Game</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> delegation: Delegation? { <span style=color:#66d9ef>get</span> <span style=color:#66d9ef>set</span> }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>play</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete Deleagtion</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SnakeTracker</span>: Delegation {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>gameDidStart</span>(<span style=color:#66d9ef>_</span> game: Game) {
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>game</span>(<span style=color:#66d9ef>_</span> game: Game) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// do something</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>gameDidEnd</span>(<span style=color:#66d9ef>_</span> game: Game) {
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete Game</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SnakeGame</span>: Game {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> delegation: Delegation?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> delegation: Delegation) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.delegation = delegation
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>play</span>() {
</span></span><span style=display:flex><span>            delegation!.gameDidStart(<span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>            delegation!.game(<span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>            delegation!.gameDidEnd(<span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> gameTracker = SnakeTracker()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> game = SnakeGame(gameTracker)
</span></span><span style=display:flex><span>    game.play()  <span style=color:#75715e>// It&#39;s the func of the game, but the detail work is done by the delegation.</span>
</span></span></code></pre></div><h2 id=behavioral>Behavioral<a hidden class=anchor aria-hidden=true href=#behavioral>#</a></h2><h3 id=chain-of-responsibility>Chain of Responsibility<a hidden class=anchor aria-hidden=true href=#chain-of-responsibility>#</a></h3><p>We set a chain of responsibility. Then it t allow the solver solve the request or sends the request to the next another solver. As the diagram shown below, the handler is one solver of the chain.</p><p>æˆ‘ä»¬è®¾å®šäº†ä¸€æ¡è´£ä»»é“¾ï¼Œç„¶åå®ƒå…è®¸å¤„ç†è€…é€‰æ‹©å¤„ç†è¯·æ±‚æˆ–è€…å°†è¯·æ±‚å‘é€ç»™ä¸‹ä¸€ä¸ªå…¶å®ƒçš„å¤„ç†è€…ã€‚ä¸‹å›¾ä¸­ï¼Œhandler æ˜¯è´£ä»»é“¾ä¸Šçš„ä¸€ä¸ªå¤„ç†è€…ã€‚</p><p><img alt="chain of responsibility" loading=lazy src=../imgs/chainOfResponsibility.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Problem wait to be solve</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Request</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> priority: Int
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> s: String
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(p: Int, s: String) {
</span></span><span style=display:flex><span>            priority = p
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.s = s
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Handler</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Thought</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>solve</span>(r: Request)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Base handler</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>People</span>: Thought {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> next: People?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setNext</span>(next: People) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.next = next
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>solve</span>(r: Request) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> n = next {
</span></span><span style=display:flex><span>                n.solve(r: r)
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#34;No people want to solve&#34;</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete handler</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Guard</span>: People {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>solve</span>(r: Request) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> r.priority <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span> {
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#34;Just be sovled by Guard [</span><span style=color:#e6db74>\(</span>r.s<span style=color:#e6db74>)</span><span style=color:#e6db74>]&#34;</span>)
</span></span><span style=display:flex><span>                print(r.s)
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>super</span>.solve(r: r)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete handler</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Commander</span>: People {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>solve</span>(r: Request) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> r.priority <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span> {
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#34;Commander solve [</span><span style=color:#e6db74>\(</span>r.s<span style=color:#e6db74>)</span><span style=color:#e6db74>]&#34;</span>)
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>super</span>.solve(r: r)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete handler</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Leader</span>: People {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>solve</span>(r: Request) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> r.priority <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span> {
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#34;Leader come and solve [</span><span style=color:#e6db74>\(</span>r.s<span style=color:#e6db74>)</span><span style=color:#e6db74>]&#34;</span>)
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>super</span>.solve(r: r)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> g = Guard()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> c = Commander()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> l = Leader()
</span></span><span style=display:flex><span>    g.setNext(next: c)
</span></span><span style=display:flex><span>    c.setNext(next: l)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> r = Request(p: <span style=color:#ae81ff>9</span>, s: <span style=color:#e6db74>&#34;Let us in&#34;</span>)
</span></span><span style=display:flex><span>    g.solve(r: r)
</span></span></code></pre></div><h3 id=command>Command<a hidden class=anchor aria-hidden=true href=#command>#</a></h3><p>Create receiver, then create command and link it to the receiver if needed, then create sender and link it to the specific command. The command mode extract the command from the business, and set a sender and receiver. The sender send message to receiver by calling the command, but not call the receiver directly.</p><p>åˆ›å»ºæ¥æ”¶è€…ï¼Œç„¶ååˆ›å»ºå‘½ä»¤å¹¶ä¸”åœ¨æœ‰éœ€è¦çš„æ—¶å€™æŠŠå®ƒè¿æ¥åˆ°æ¥æ”¶è€…ï¼Œç„¶ååˆ›å»ºå‘é€è€…å¹¶ä¸”æŠŠå®ƒè¿æ¥åˆ°å‘½ä»¤ã€‚å‘½ä»¤æ¨¡å¼ä»ä¸šåŠ¡ä¸­æŠ½å‡ºå‘½ä»¤çš„éƒ¨åˆ†ï¼Œç„¶åè®¾ç½®ä¸€ä¸ªå‘é€è€…å’Œæ¥æ”¶è€…ã€‚å‘é€è€…é€šè¿‡è°ƒç”¨å‘½ä»¤å‘æ¥å—è€…å‘é€ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨æ¥æ”¶è€…ã€‚</p><p><img alt=command loading=lazy src=../imgs/command.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Message</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TableInfo</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> tableNo: Int?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(tableNo: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.tableNo = tableNo
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Receiver</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cooker</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>cookMeal</span>(info: TableInfo) {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Cook meal for: </span><span style=color:#e6db74>\(</span>info.tableNo!<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>sayHello</span>(info: TableInfo) {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Say hello to: </span><span style=color:#e6db74>\(</span>info.tableNo!<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>reheatFood</span>(info: TableInfo) {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Reheat food for: </span><span style=color:#e6db74>\(</span>info.tableNo!<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Command</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Command</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>(info: TableInfo)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete Command</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ServeCommand</span>: Command {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> cooker: Cooker?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(cooker: Cooker) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.cooker = cooker
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>execute</span>(info: TableInfo) {
</span></span><span style=display:flex><span>            cooker?.sayHello(info: info)
</span></span><span style=display:flex><span>            cooker?.cookMeal(info: info)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Sender</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Waiter</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> command: Command
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(command: Command) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.command = command
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>executeCommand</span>(info: TableInfo) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.command.execute(info: info)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> cooker = Cooker()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> command = ServeCommand(cooker: cooker)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> waiter = Waiter(command: command)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    waiter.executeCommand(info: TableInfo(tableNo: <span style=color:#ae81ff>4</span>))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Print:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Say hello to: 4</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Cook meal for: 4</span>
</span></span></code></pre></div><h3 id=iterator>Iterator<a hidden class=anchor aria-hidden=true href=#iterator>#</a></h3><p>The idea of the iterator is to extract the traversal behavior into an independent iterator object. The collection has some elements, and we use the iterator to get each element step by step.</p><p>è¿­ä»£å™¨çš„ä¸»è¦æ€æƒ³æ˜¯å°†éå†è¡Œä¸ºæŠ½å–ä¸ºå•ç‹¬çš„è¿­ä»£å™¨å¯¹è±¡ã€‚</p><p><img alt=iterator loading=lazy src=../imgs/iterator.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Element in the collection</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Node</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> info: String = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> s: String) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.info = s
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Iterator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Iterator</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>hasNext</span>() -&gt; Bool
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getNext</span>() -&gt; Node
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete iterator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PositiveIterator</span>: Iterator {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> collection: Collection
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> curIndex = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> c: Collection) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.collection = c
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>hasNext</span>() -&gt; Bool {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> curIndex <span style=color:#f92672>&lt;</span> collection.nodes.count {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span>  <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getNext</span>() -&gt; Node {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> node = collection.nodes[curIndex]
</span></span><span style=display:flex><span>            curIndex <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> node
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete iterator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RevertIerator</span>: Iterator {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> collection: Collection
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> curIndex = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> c: Collection) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.collection = c
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.curIndex = collection.nodes.count <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>hasNext</span>() -&gt; Bool {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> curIndex <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span>  <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getNext</span>() -&gt; Node {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> node = collection.nodes[curIndex]
</span></span><span style=display:flex><span>            curIndex <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> node
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Collection</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Collection</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> nodes: [Node] { <span style=color:#66d9ef>get</span> <span style=color:#66d9ef>set</span> }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getIterator</span>() -&gt; Iterator
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getRevertIterator</span>() -&gt; Iterator
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete collecton</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NodesCollection</span>: Collection {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> nodes: [Node]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.nodes = []
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>append</span>(<span style=color:#66d9ef>_</span> n: Node) {
</span></span><span style=display:flex><span>            nodes.append(n)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getIterator</span>() -&gt; Iterator {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> PositiveIterator(<span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getRevertIterator</span>() -&gt; Iterator {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> RevertIerator(<span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> str = <span style=color:#e6db74>&#34;hello world&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> collection = NodesCollection()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> s <span style=color:#66d9ef>in</span> str {
</span></span><span style=display:flex><span>        collection.append(Node(String(s)))
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> it = collection.getIterator()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (it.hasNext()) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> n = it.getNext()
</span></span><span style=display:flex><span>        print(n.info, terminator: <span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    it = collection.getRevertIterator()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (it.hasNext()) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> n = it.getNext()
</span></span><span style=display:flex><span>        print(n.info, terminator: <span style=color:#e6db74>&#34;_&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><h3 id=mediator>Mediator<a hidden class=anchor aria-hidden=true href=#mediator>#</a></h3><p>The mediator constrains the interaction between the component, the components can only notify the mediator and the mediator can manage the action of all the components it contains.</p><p>ä¸­ä»‹è€…é™åˆ¶äº†ç»„ä»¶ä¹‹é—´çš„äº¤äº’ï¼Œç»„ä»¶åªèƒ½é€šçŸ¥ä¸­ä»‹ä¸€äº›æŒ‡ä»¤ï¼Œç„¶åä¸­ä»‹è€…ç®¡ç†å®ƒå†…éƒ¨æ‹¥æœ‰çš„æ‰€æœ‰ç»„ä»¶çš„æ•°æ®æ“ä½œä¸è¡Œä¸ºã€‚</p><p><img alt=mediator loading=lazy src=../imgs/mediator.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Component basic class</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Component</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> m: Mediator
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(mediator: Mediator) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.m = mediator
</span></span><span style=display:flex><span>            m.notify(component: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete component</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Button</span>: Component {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>click</span>() {
</span></span><span style=display:flex><span>            m.notify(component: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete component</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CheckBox</span>: Component {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> check = <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>isCheck</span>() -&gt; Bool {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> check
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete component</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PasswordText</span>: Component {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> text: String = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getText</span>() -&gt; String{
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> text
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete component</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UserNameText</span>: Component {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> text: String = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getText</span>() -&gt; String{
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> text
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Mediator</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>notify</span>(component: Component)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete mediator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LoginMediator</span>: Mediator {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> btnLogin: Button?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> tickSavePassword: CheckBox?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> password: PasswordText?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> userName: UserNameText?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>notify</span>(component: Component) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> component <span style=color:#66d9ef>is</span> Button {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> btn = component <span style=color:#66d9ef>as</span>! Button
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>self</span>.btnLogin == <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// self btn initialize</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>self</span>.btnLogin = btn
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> 
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (canLogin(userName: userName?.getText(), password: password?.getText())) {
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>&#34;Login success&#34;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> wantSave = tickSavePassword?.isCheck() {
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// save the userName and password</span>
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>&#34;Login failed&#34;</span>)
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> component <span style=color:#66d9ef>is</span> CheckBox {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> box = component <span style=color:#66d9ef>as</span>! CheckBox
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>self</span>.tickSavePassword = box
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> component <span style=color:#66d9ef>is</span> UserNameText {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> userName = component <span style=color:#66d9ef>as</span>! UserNameText
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>self</span>.userName = userName
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> component <span style=color:#66d9ef>is</span> PasswordText {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> password = component <span style=color:#66d9ef>as</span>! PasswordText 
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>self</span>.password = password
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// The function check whether the username and password match</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>canLogin</span>(userName: String?, password: String?) -&gt; Bool {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> userName == <span style=color:#66d9ef>nil</span> <span style=color:#f92672>||</span> password == <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> name = userName, <span style=color:#66d9ef>let</span> word = password{
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> name == <span style=color:#e6db74>&#34;hello&#34;</span> <span style=color:#f92672>&amp;&amp;</span> word == <span style=color:#e6db74>&#34;Mike&#34;</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> mediator = LoginMediator()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> userName = UserNameText(mediator: mediator)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> password = PasswordText(mediator: mediator)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> tickSavePassword = CheckBox(mediator: mediator)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> btnLogin = Button(mediator: mediator)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    userName.text = <span style=color:#e6db74>&#34;hello&#34;</span>
</span></span><span style=display:flex><span>    password.text = <span style=color:#e6db74>&#34;Mike&#34;</span>
</span></span><span style=display:flex><span>    tickSavePassword.check = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    btnLogin.click()
</span></span></code></pre></div><h3 id=memento>Memento<a hidden class=anchor aria-hidden=true href=#memento>#</a></h3><p>It allow to save or recover the object state before without expose the objectâ€™s implemented detail. The originator can create the snapshot of itself and can restore the snapshot when it need. The memento is a value object of the originatorâ€™s snapshot state, itâ€™s built by the initializer and pass the information by only one time. The caretaker can only use the originatorâ€™s <code>makeMemento()</code> and <code>restore()</code>.</p><p>å®ƒå…è®¸åœ¨ä¸æš´éœ²å¯¹è±¡å®ç°ç»†èŠ‚çš„æƒ…å†µä¸‹ï¼Œä¿å­˜å’Œæ¢å¤å¯¹è±¡ä¹‹å‰çš„çŠ¶æ€ã€‚åŸå‘å™¨å¯ä»¥åˆ›å»ºå®ƒè‡ªå·±çš„å¿«ç…§å¹¶ä¸”åœ¨éœ€è¦çš„æ—¶å€™æ¢å¤å¿«ç…§åˆ°è‡ªèº«ã€‚å¤‡å¿˜å½•æ˜¯ä¸€ä¸ªç”¨äºå­˜æ”¾åŸå‘å™¨å¿«ç…§çŠ¶æ€çš„å€¼å¯¹è±¡ï¼Œå®ƒåªé€šè¿‡æ„é€ å‡½æ•°ä¼ é€’çŠ¶æ€ä¿¡æ¯ã€‚è´Ÿè´£äººåªå¯ä»¥ä½¿ç”¨åŸå‘å™¨çš„ â€œåˆ›å»ºå¿«ç…§â€ å’Œ â€œæ¢å¤çŠ¶æ€â€ çš„æ–¹æ³•ã€‚</p><p><img alt=memento loading=lazy src=../imgs/memento.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Originator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Animal</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getMemento</span>() -&gt; Memento
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Memento</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Memento</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>restore</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete originator</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Dog</span>: Animal {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> age: Int
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> weight: Float
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> legCount: Int
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(age: Int, weight: Float, legCount: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.age = age
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.weight = weight
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.legCount = legCount
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getMemento</span>() -&gt; Memento {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> DogData(dog: <span style=color:#66d9ef>self</span>, age: age, weight: weight, legCount: legCount)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setAge</span>(age: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.age = age
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setWeight</span>(weight: Float) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.weight = weight
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setLegCount</span>(legCount: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.legCount = legCount
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>info</span>() -&gt; String {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;age: </span><span style=color:#e6db74>\(</span>age<span style=color:#e6db74>)</span><span style=color:#e6db74> weight: </span><span style=color:#e6db74>\(</span>weight<span style=color:#e6db74>)</span><span style=color:#e6db74> legCount: </span><span style=color:#e6db74>\(</span>legCount<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete memento</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DogData</span>: Memento {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> age: Int
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> weight: Float
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> legCount: Int
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> dog: Dog?
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(dog: Dog, age: Int, weight: Float, legCount: Int) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.dog = dog
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.age = age
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.weight = weight
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.legCount = legCount
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>restore</span>() {
</span></span><span style=display:flex><span>            dog?.setAge(age: age)
</span></span><span style=display:flex><span>            dog?.setWeight(weight: weight)
</span></span><span style=display:flex><span>            dog?.setLegCount(legCount: legCount)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// CareTaker</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Recored</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> dog: Dog
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> history: [Memento] = []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(dog: Dog) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.dog = dog
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>save</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> backup = dog.getMemento()
</span></span><span style=display:flex><span>            history.append(backup)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (history.count <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span>) {
</span></span><span style=display:flex><span>                history.remove(at: <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>undo</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> history.count <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> 
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> data = history[history.count <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>            data.restore()
</span></span><span style=display:flex><span>            history.remove(at: history.count <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> dog = Dog(age: <span style=color:#ae81ff>2</span>, weight: <span style=color:#ae81ff>15</span>, legCount: <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> record = Recored(dog: dog)
</span></span><span style=display:flex><span>    record.save()
</span></span><span style=display:flex><span>    print(dog.info())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    dog.setAge(age: <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>    dog.setWeight(weight: <span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>    print(dog.info())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    record.undo()
</span></span><span style=display:flex><span>    print(dog.info())
</span></span></code></pre></div><h3 id=observer>Observer<a hidden class=anchor aria-hidden=true href=#observer>#</a></h3><p>The publisher has some subscribers reference, it can add subscriber, remove subscriber, and notify all subscriber.</p><p>å‘å¸ƒè€…æŒæœ‰ä¸€äº›è®¢é˜…è€…çš„å¼•ç”¨ï¼Œå®ƒå¯ä»¥æ·»åŠ è®¢é˜…è€…ï¼Œä¹Ÿå¯ä»¥ç§»é™¤è®¢é˜…è€…ï¼Œæˆ–è€…æ˜¯é€šçŸ¥æ‰€æœ‰çš„è®¢é˜…è€…ã€‚</p><p><img alt=observer loading=lazy src=../imgs/observer.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Message</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> text: String = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> m: String) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.text = m
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Event</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> text: String = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> e: String) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.text = e
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Subscriber</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Listener</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>update</span>(message: Message)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Publisher</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Publisher</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>subscribe</span>(event: Event, listener: Listener)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>remove</span>(event: Event)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>notify</span>(event: Event, message: Message)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>notifyAll</span>(message: Message)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete listener</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ListenerA</span>: Listener {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>update</span>(message: Message) {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;A do: </span><span style=color:#e6db74>\(</span>message.text<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete listener</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ListenerB</span>: Listener {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>update</span>(message: Message) {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;B do: </span><span style=color:#e6db74>\(</span>message.text<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete publisher</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ViewPublisher</span>: Publisher {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> listeners: [String: Listener] = [:]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>subscribe</span>(event: Event, listener: Listener) {
</span></span><span style=display:flex><span>            listeners[event.text] = listener
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>remove</span>(event: Event) {
</span></span><span style=display:flex><span>            listeners.removeValue(forKey: event.text)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>notify</span>(event: Event, message: Message) {
</span></span><span style=display:flex><span>            listeners[event.text]?.update(message: message)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>notifyAll</span>(message: Message) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> item <span style=color:#66d9ef>in</span> listeners.values {
</span></span><span style=display:flex><span>                item.update(message: message)
</span></span><span style=display:flex><span>            }  
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> publisher = ViewPublisher()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> a = ListenerA()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> b = ListenerB()
</span></span><span style=display:flex><span>    publisher.subscribe(event: Event(<span style=color:#e6db74>&#34;look&#34;</span>), listener: a)
</span></span><span style=display:flex><span>    publisher.subscribe(event: Event(<span style=color:#e6db74>&#34;find&#34;</span>), listener: b)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    publisher.notify(event: Event(<span style=color:#e6db74>&#34;look&#34;</span>), message: Message(<span style=color:#e6db74>&#34;Firstly, welcome.&#34;</span>))
</span></span><span style=display:flex><span>    print()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    publisher.notifyAll(message: Message(<span style=color:#e6db74>&#34;Hello world!&#34;</span>))
</span></span><span style=display:flex><span>    print()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    publisher.remove(event: Event(<span style=color:#e6db74>&#34;look&#34;</span>))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    publisher.notifyAll(message: Message(<span style=color:#e6db74>&#34;The end.&#34;</span>))
</span></span></code></pre></div><h3 id=state>State<a hidden class=anchor aria-hidden=true href=#state>#</a></h3><p>The state mode enable the class to change its behavior when its inner state changed. The <code>StateContext</code> only do the switch work, and the detail work is done by <code>State</code> object. The context manage the statements in a high level, it can switch some different state when we need. The context inject a reference to the concrete state object to enable the state to delegate the detail work.
çŠ¶æ€æ¨¡å¼ä¸­ï¼Œå½“ç±»çš„çŠ¶æ€æ”¹å˜æ—¶ï¼Œç±»çš„è¡Œä¸ºéšç€æ”¹å˜ã€‚çŠ¶æ€ä¸Šä¸‹æ–‡ç±»åªæ‰§è¡ŒçŠ¶æ€åˆ‡æ¢å·¥ä½œï¼Œå…·ä½“çš„å·¥ä½œç»†èŠ‚äº¤ç»™çŠ¶æ€å¯¹è±¡å»æ‰§è¡Œã€‚ä¸Šä¸‹æ–‡å¯¹è±¡åœ¨ä¸€ä¸ªè¾ƒé«˜çš„å±‚æ¬¡ç®¡ç†ç€è‡ªèº«çš„çŠ¶æ€ï¼Œå®ƒå¯ä»¥åœ¨æˆ‘ä»¬æœ‰éœ€è¦çš„æ—¶å€™åˆ‡æ¢ä¸åŒçš„çŠ¶æ€ã€‚ä¸Šä¸‹æ–‡å¯¹è±¡æ³¨å…¥äº†ä¸€ä¸ªè‡ªå·±çš„å¼•ç”¨ç»™çŠ¶æ€å¯¹è±¡ï¼Œä½¿å¾—çŠ¶æ€å¯¹è±¡å¯ä»¥ä»£ç†åœ¨åˆ‡æ¢çŠ¶æ€æ—¶å€™çš„ç»†èŠ‚å·¥ä½œã€‚</p><p><img alt=state loading=lazy src=../imgs/state.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Abstract state</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>State</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> context: Context?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> name: String = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(context: Context?) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.context = context
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete state</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NewState</span>: State {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>init</span>(context: Context?) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>(context: context)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.name = <span style=color:#e6db74>&#34;New&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>start</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Call start&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>self</span>.name == <span style=color:#e6db74>&#34;New&#34;</span> {
</span></span><span style=display:flex><span>                context?.setState(state: RunnableState(context: context))
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#34;Can&#39;t go to runnable&#34;</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete state</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RunnableState</span>: State {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>init</span>(context: Context?) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>(context: context)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.name = <span style=color:#e6db74>&#34;Runnable&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getCpu</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>self</span>.name == <span style=color:#e6db74>&#34;Runnable&#34;</span> {
</span></span><span style=display:flex><span>                context?.setState(state: RunningState(context: context))
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#34;Can&#39;t go to running&#34;</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete state</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RunningState</span>: State {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>init</span>(context: Context?) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>(context: context)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.name = <span style=color:#e6db74>&#34;Running&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>suspend</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>self</span>.name == <span style=color:#e6db74>&#34;Running&#34;</span> {
</span></span><span style=display:flex><span>                context?.setState(state: BlockState(context: context))
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>stop</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>self</span>.name == <span style=color:#e6db74>&#34;Running&#34;</span> {
</span></span><span style=display:flex><span>                context?.setState(state: DeadState(context: context))
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete state</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span>  <span style=color:#a6e22e>BlockState</span>: State {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>init</span>(context: Context?) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>(context: context)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.name = <span style=color:#e6db74>&#34;Block&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>resume</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> name == <span style=color:#e6db74>&#34;Block&#34;</span> {
</span></span><span style=display:flex><span>                context?.setState(state: RunnableState(context: context))
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete state</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DeadState</span>: State {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>init</span>(context: Context?) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>super</span>.<span style=color:#66d9ef>init</span>(context: context)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.name = <span style=color:#e6db74>&#34;Dead&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Thread Context</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Context</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> state: State?
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.state = NewState(context: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>setState</span>(state: State) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.state = state
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getState</span>() -&gt; State? {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>self</span>.state
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>start</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = <span style=color:#66d9ef>self</span>.state <span style=color:#66d9ef>as</span>? NewState {
</span></span><span style=display:flex><span>                s.start()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>suspend</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = <span style=color:#66d9ef>self</span>.state <span style=color:#66d9ef>as</span>?  RunningState {
</span></span><span style=display:flex><span>                s.suspend()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>resume</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = <span style=color:#66d9ef>self</span>.state <span style=color:#66d9ef>as</span>? BlockState {
</span></span><span style=display:flex><span>                s.resume()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getCpu</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = <span style=color:#66d9ef>self</span>.state <span style=color:#66d9ef>as</span>? RunnableState {
</span></span><span style=display:flex><span>                s.getCpu()  <span style=color:#75715e>// It will switch to the running state.</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span>  <span style=color:#a6e22e>stop</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> s = <span style=color:#66d9ef>self</span>.state <span style=color:#66d9ef>as</span>? RunningState {
</span></span><span style=display:flex><span>                s.stop()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> context = Context()
</span></span><span style=display:flex><span>    context.start()   <span style=color:#75715e>// It will be runnable then.</span>
</span></span><span style=display:flex><span>    context.getCpu()  <span style=color:#75715e>// It will be running then.</span>
</span></span><span style=display:flex><span>    context.suspend() <span style=color:#75715e>// It will be blocked then.</span>
</span></span><span style=display:flex><span>    context.resume()  <span style=color:#75715e>// It will be runnable then.</span>
</span></span><span style=display:flex><span>    context.getCpu()  <span style=color:#75715e>// It will be running then.</span>
</span></span><span style=display:flex><span>    context.stop()    <span style=color:#75715e>// It will be dead then.</span>
</span></span></code></pre></div><h3 id=strategy>Strategy<a hidden class=anchor aria-hidden=true href=#strategy>#</a></h3><p>Strategy mode set some solution class, and each solution can be substituted by other solution easily. When we face different problem, we choose different solution to solve problem. The <code>Problem</code> class hold a reference of <code>Strategy</code> interface to use different strategy.
ç­–ç•¥æ¨¡å¼è®¾å®šäº†ä¸€äº›ç®—æ³•ç±»ï¼Œæ¯ä¸ªç®—æ³•ç±»å¯ä»¥è¢«å…¶å®ƒç®—æ³•ç±»æ‰€æ›¿æ¢ã€‚å½“æˆ‘ä»¬é¢å¯¹ä¸åŒçš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸åŒçš„ç­–ç•¥æ¥è§£å†³é—®é¢˜ã€‚â€œé—®é¢˜â€ ç±»æŒæœ‰ â€œç­–ç•¥â€æ¥å£ï¼Œ ä»¥ä¾¿ä½¿ç”¨ä¸åŒçš„ç­–ç•¥ã€‚</p><p><img alt=strategy loading=lazy src=../imgs/strategy.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Strategy</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>sort</span>(<span style=color:#66d9ef>_</span> nums: <span style=color:#66d9ef>inout</span> [Int]) -&gt; [Int]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Strategy A</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SelectedSort</span>: Strategy {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>sort</span>(<span style=color:#66d9ef>_</span> nums: <span style=color:#66d9ef>inout</span> [Int]) -&gt; [Int] {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Selected sort&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> len = nums.count
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> nums
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> i <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>0.</span>.&lt;len {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> minIndex = i
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> j <span style=color:#66d9ef>in</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)..&lt;len {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> nums[j] <span style=color:#f92672>&lt;</span> nums[minIndex] {
</span></span><span style=display:flex><span>                        minIndex = j
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> tmp = nums[i]
</span></span><span style=display:flex><span>                nums[i] = nums[minIndex]
</span></span><span style=display:flex><span>                nums[minIndex] = tmp
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> nums
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Strategy B</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>InsertSort</span>: Strategy {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>sort</span>(<span style=color:#66d9ef>_</span> nums: <span style=color:#66d9ef>inout</span> [Int]) -&gt; [Int] {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Insert sort&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> len = nums.count
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> nums
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> i <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1.</span>.&lt;len {   
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> left = i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>true</span> {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>left</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> nums[i] <span style=color:#f92672>&gt;</span> nums[<span style=color:#66d9ef>left</span>] {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>var</span> cover = i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>var</span> t = nums[i]
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>while</span> cover <span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>left</span> {
</span></span><span style=display:flex><span>                            nums[cover <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] = nums[cover] 
</span></span><span style=display:flex><span>                            cover <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                        } 
</span></span><span style=display:flex><span>                        nums[<span style=color:#66d9ef>left</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] = t
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>                    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>left</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> nums
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Problem</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> strategy: Strategy
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>init</span>(strategy: Strategy) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.strategy = strategy
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>solve</span>(<span style=color:#66d9ef>_</span> nums: <span style=color:#66d9ef>inout</span> [Int]) -&gt; [Int] {
</span></span><span style=display:flex><span>            strategy.sort(&amp;nums)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>changeStrategy</span>(strategy: Strategy) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.strategy = strategy
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> nums = [<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> a = SelectedSort()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> b = InsertSort()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> problem = Problem(strategy: a)
</span></span><span style=display:flex><span>    problem.solve(&amp;nums)
</span></span><span style=display:flex><span>    print(nums)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    nums.shuffle()
</span></span><span style=display:flex><span>    print(nums)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    problem.changeStrategy(strategy: b)
</span></span><span style=display:flex><span>    problem.solve(&amp;nums)
</span></span><span style=display:flex><span>    print(nums)
</span></span></code></pre></div><h3 id=template-method>Template Method<a hidden class=anchor aria-hidden=true href=#template-method>#</a></h3><p>The super class define an algorithm structure, and the subclass can override the method without changing the structure. Depart an algorithm into a series of step, and rewrite these step as method, then call these method in the template method.</p><p>è¶…ç±»å®šä¹‰äº†ä¸€ä¸ªç®—æ³•æ¡†æ¶ï¼Œå­ç±»å¯ä»¥åœ¨ä¸æ”¹åŠ¨æ¡†æ¶çš„æƒ…å†µä¸‹ä¾æ®éœ€è¦æ¥é‡å†™æ–¹æ³•ã€‚æŠŠç®—æ³•æ‹†åˆ†ä¸ºä¸€ç³»åˆ—çš„æ­¥éª¤ï¼ŒæŠŠè¿™äº›æ­¥éª¤å†™æˆæ–¹æ³•ï¼Œç„¶åå¯ä»¥åœ¨æ¨¡æ¿æ–¹æ³•ä¸­è°ƒç”¨è¿™äº›æ–¹æ³•ã€‚</p><p><img alt=templateMethod loading=lazy src=../imgs/templateMethod.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#75715e>// Abstract class</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>House</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Use final to prevent the subclass override the template method.</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>build</span>(){
</span></span><span style=display:flex><span>            makeRoot()
</span></span><span style=display:flex><span>            makeWall()
</span></span><span style=display:flex><span>            makeWindows()
</span></span><span style=display:flex><span>            makeRoof()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeRoot</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Use cement to construct root.&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeWall</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add white wall&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeWindows</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add window&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeRoof</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add smooth roof&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete class A</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EastenHouse</span>: House {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeWall</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add red wall.&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeWindows</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add wooden windows.&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeRoof</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add wooden roof.&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Concrete class B</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WestenHouse</span>: House {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeWindows</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add iron windows&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>makeRoof</span>() {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Add cement roof&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> house = EastenHouse()
</span></span><span style=display:flex><span>    house.build()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> houseB = WestenHouse()
</span></span><span style=display:flex><span>    houseB.build()
</span></span></code></pre></div><h3 id=visitor>Visitor<a hidden class=anchor aria-hidden=true href=#visitor>#</a></h3><p>Visitor mode can isolate the algorithm and the object which algorithm affect. (Depart the server and the visitor). It put the new behaviors into a <code>Visitor</code> class, then pass the existed objectâ€™s reference to the visitor to do the behaviors. It just visit the data of the object, but not change the original data.</p><p>è®¿é—®è€…æ¨¡å¼å¯ä»¥éš”ç¦»ç®—æ³•å’Œè¢«è¿™ä¸ªç®—æ³•å½±å“çš„å¯¹è±¡ï¼ˆåˆ†ç¦»æœåŠ¡è€…å’Œè®¿é—®è€…ï¼‰ã€‚å®ƒå°†æ–°çš„è¡Œä¸ºæ”¾ç½®åœ¨ä¸€ä¸ªç§°ä¸º â€œè®¿é—®è€…â€ çš„å¯¹è±¡ä¸­ï¼Œç„¶åä¼ é€’åŸæœ‰å¯¹è±¡çš„å¼•ç”¨æ¥æ‰§è¡Œä¸€äº›è¡Œä¸ºã€‚å®ƒåªæ˜¯è®¿é—®å¯¹è±¡æ•°æ®ï¼Œè€Œæ²¡æœ‰æ”¹å˜æºæ•°æ®ã€‚</p><p><img alt=vistor loading=lazy src=../imgs/vistor.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Visitor</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(d: Dog)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(c: Cat)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(h: Horse)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Element</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>accept</span>(v: Visitor)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Element A</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Dog</span>: Element {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> name = <span style=color:#e6db74>&#34;dog&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> age = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>accept</span>(v: Visitor) {
</span></span><span style=display:flex><span>            v.visit(d: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Element B</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cat</span>: Element {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> name = <span style=color:#e6db74>&#34;cat&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> age = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>accept</span>(v: Visitor) {
</span></span><span style=display:flex><span>            v.visit(c: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Element C</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Horse</span>: Element {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> name = <span style=color:#e6db74>&#34;horse&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> age = <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>accept</span>(v: Visitor) {
</span></span><span style=display:flex><span>            v.visit(h: <span style=color:#66d9ef>self</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Visitor 1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NameVisitor</span>: Visitor {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(d: Dog) {
</span></span><span style=display:flex><span>            print(d.name)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(c: Cat) {
</span></span><span style=display:flex><span>            print(c.name)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(h: Horse) {
</span></span><span style=display:flex><span>            print(h.name)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Visitor 2</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AgeVisitor</span>: Visitor {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(d: Dog) {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Dog age: </span><span style=color:#e6db74>\(</span>d.age<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(c: Cat) {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Cat age: </span><span style=color:#e6db74>\(</span>c.age<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>visit</span>(h: Horse) {
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Horse age: </span><span style=color:#e6db74>\(</span>h.age<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> dog = Dog()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> cat = Cat()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> horse = Horse()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> nameVisitor = NameVisitor()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> ageVisitor = AgeVisitor()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    dog.accept(v: nameVisitor)
</span></span><span style=display:flex><span>    cat.accept(v: nameVisitor)
</span></span><span style=display:flex><span>    horse.accept(v: nameVisitor)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    dog.accept(v: ageVisitor)
</span></span><span style=display:flex><span>    cat.accept(v: ageVisitor)
</span></span><span style=display:flex><span>    horse.accept(v: ageVisitor)
</span></span></code></pre></div><h2 id=æ¨¡å¼çš„ç‰¹å¾ä¸åŒºåˆ«>æ¨¡å¼çš„ç‰¹å¾ä¸åŒºåˆ«<a hidden class=anchor aria-hidden=true href=#æ¨¡å¼çš„ç‰¹å¾ä¸åŒºåˆ«>#</a></h2><h3 id=ç»“æ„å‹>ç»“æ„å‹<a hidden class=anchor aria-hidden=true href=#ç»“æ„å‹>#</a></h3><ul><li>é€‚é…å™¨æ¨¡å¼çš„ç›®çš„æ˜¯ä¸ºäº†è®©ç±» A å»æ¨¡ä»¿ç±» Bï¼Œä»è€Œåœ¨éœ€è¦ç±» B çš„åœ°æ–¹å¯ä»¥ç›´æ¥ä½¿ç”¨ç±» A æ›¿ä»£ï¼Œé€‚é…å™¨Cæ—¢å…·æœ‰ B çš„å±æ€§ï¼Œåˆçœ‹èµ·æ¥åƒæ˜¯ B ï¼ˆå› ä¸ºé€‚é…å™¨ç»§æ‰¿è‡ªç±» Bï¼‰</li><li>æ¡¥æ¥æ¨¡å¼æ˜¯å…·ä½“çš„ç±» A ä¸­å…·æœ‰æŠ½è±¡æ¥å£ Bï¼Œæ„é€  A çš„æ—¶å€™æ³¨å…¥ä¸€ä¸ª B çš„å®ä½“å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ä½¿ç”¨å¯¹è±¡ A çš„æ—¶å€™ï¼Œå¯ä»¥<strong>è°ƒç”¨æ¥å£ B</strong> æ¥å®ç°å¯¹åº”åŠŸèƒ½ï¼Œè¿™æ ·çš„ç±» A æ˜¯ä¾èµ–äºæ¥å£è€Œä¸æ˜¯å…·ä½“çš„ç±»ã€‚</li><li>æ¡¥æ¥æ¨¡å¼æ˜¯ä¸¤ä¸ªç±» A ä¸ B ä¹‹é—´ï¼Œä½¿ç”¨ä¸€ä¸ªæ¥å£ï¼Œç”± B å®ç°ï¼Œ æ³¨å…¥ Aã€‚</li><li>ç»„åˆæ¨¡å¼æ˜¯ç»„ä»¶æ¨¡å—ä¸å®¹å™¨ï¼ˆæŠ½è±¡æ¥å£ï¼‰éƒ½å®ç°åŒä¸€æ¥å£ï¼Œå®¹å™¨é‡Œé¢å¯ä»¥æŒæœ‰å¤šä¸ªæ¥å£å®ä¾‹ï¼ˆç”±ç»„ä»¶æ¨¡å—å®ä¾‹æ¥æ³¨å…¥ï¼‰ï¼Œå½¢æˆæ ‘çŠ¶ç»“æ„ã€‚</li><li>è£…é¥°å™¨æ¨¡å¼æ˜¯ç»„ä»¶ä¸è£…é¥°å™¨ï¼ˆæŠ½è±¡æ¥å£ï¼‰éƒ½å®ç°åŒä¸€æ¥å£ï¼Œè£…é¥°å™¨é‡Œé¢æŒæœ‰ä¸€ä¸ªæ¥å£å®ä¾‹ï¼ˆç”±ç»„ä»¶æ¨¡å—å®ä¾‹æ¥æ³¨å…¥ï¼‰ï¼Œ è£…é¥°å™¨å¯¹æŒæœ‰çš„å®ä¾‹æ·»åŠ é™„å¸¦åŠŸèƒ½ã€‚</li><li>å§”æ‰˜æ¨¡å¼ï¼ˆdelegateï¼‰æ˜¯è®©ä¸€ä¸ªå¯¹è±¡æ‰®æ¼”å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºã€‚å§”æ‰˜å¯¹è±¡æš‚æ—¶æŒæœ‰åˆ°å¦å¤–å¯¹è±¡çš„å¼•ç”¨ã€‚åœ¨é€‚å½“æ—¶é—´å‘æ¶ˆæ¯ç»™å¦å¤–å¯¹è±¡ã€‚</li><li>ä»£ç†æ¨¡å¼ï¼ˆproxyï¼‰æ¯”å§”æ‰˜æ›´ä¸ºä¸¥æ ¼ï¼Œè‹¥å¹²å¯¹è±¡å®ç°åŒä¸€æ¥å£ã€‚</li></ul><h3 id=è¡Œä¸ºå‹>è¡Œä¸ºå‹<a hidden class=anchor aria-hidden=true href=#è¡Œä¸ºå‹>#</a></h3><ul><li><p>è´£ä»»é“¾æ¨¡å¼ï¼ˆchain of responsibilityï¼‰æ¨¡å¼ä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡æŒæœ‰æŒ‡å‘å¦ä¸€å¯¹è±¡çš„å¼•ç”¨ Aï¼ˆç”¨äºè½¬ç§»è´£ä»»ï¼‰ï¼Œè¯¢é—®å½“å‰å¯¹è±¡ï¼Œå½“å‰å¯¹è±¡è‹¥æœ‰èƒ½åŠ›å¤„ç†äº‹åŠ¡åˆ™å¤„ç†ï¼Œè‹¥æ²¡æœ‰èƒ½åŠ›å¤„ç†äº‹åŠ¡åˆ™æŠŠäº‹åŠ¡ç§»äº¤ç»™å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼ˆå¼•ç”¨ A æ‰€æŒ‡ï¼‰å¤„ç†ã€‚</p></li><li><p>å‘½ä»¤æ¨¡å¼ï¼ˆcommand) å‘é€è€…å’Œæ¥æ”¶è€…ä½¿ç”¨å‘½ä»¤è¿›è¡Œé—´æ¥æ²Ÿé€šï¼Œå¸¸ç”¨äºè§†å›¾å’Œæ§åˆ¶å™¨çš„åˆ†ç¦»ï¼ˆè§†å›¾ä¸ºå‘é€è€…ï¼Œæ§åˆ¶å™¨ä¸ºæ¥æ”¶è€…ï¼‰ã€‚è‹¥ä¸è´£ä»»é“¾ç»“åˆï¼Œåˆ™ä¸ºå‘½ä»¤åœ¨ä¼ é€’ç»™æ¥æ”¶è€…çš„æ—¶å€™ï¼Œæ˜¯ä¼ é€’åˆ°æ¥æ”¶è€…é“¾ä¸Šï¼Œä»è€Œå¯»æ±‚æ½œåœ¨çš„æ¥æ”¶è€…ã€‚</p></li><li><p>ä¸­ä»‹è€…æ¨¡å¼ï¼ˆmediatorï¼‰è®¾ç½®ä¸€ä¸ªä¸­ä»‹è€…æ¥ç®¡ç†é‚£äº›æ¥è‡ªç»„ä»¶çš„è°ƒç”¨ï¼Œä¸­ä»‹è€…æ‹¥æœ‰å„ä¸ªç»„ä»¶çš„å¼•ç”¨ï¼Œç«™åœ¨æ›´é«˜çš„å±‚æ¬¡ä¸Šå¯¹ç»„ä»¶è¿›è¡Œç®¡ç†ã€‚ç»„ä»¶ä¹‹é—´é€šè¿‡ä¸­ä»‹è€…æ¥å‘ç”Ÿäº¤äº’ï¼Œè€Œä¸æ˜¯ç»„ä»¶ä¹‹é—´è¿›è¡Œè€¦åˆã€‚</p></li><li><p>å¤‡å¿˜å½•æ¨¡å¼ï¼ˆmementoï¼‰ï¼Œä¸ºåŸå‘å™¨æ·»åŠ ä¸€ä¸ªå¤‡å¿˜å½•å¯¹è±¡ç”¨äºå­˜æ”¾åŸå‘å™¨çš„çš„çŠ¶æ€ä¿¡æ¯ï¼Œä½¿ç”¨ä¸€ä¸ªè´Ÿè´£äººå¯¹è±¡æ¥ç®¡ç†å¤‡å¿˜å½•çš„å¢åŠ ä¸å›æ»šï¼Œå¯ä»¥å¯¹åŸå‘å™¨çš„ç‰ˆæœ¬è¿›è¡Œæ§åˆ¶ã€‚</p></li><li><p>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆobserverï¼‰ï¼Œå‘å¸ƒè€…æŒæœ‰å¤šä¸ªè®¢é˜…è€…çš„å¼•ç”¨ï¼Œå½“æœ‰éœ€è¦å‘å¸ƒæ–°æ¶ˆæ¯æ—¶ï¼Œå‡†ç¡®åœ°å‘æ¯ä¸ªè®¢é˜…è€…å‘é€ä¿¡æ¯ã€‚</p><p>ä¸­ä»‹è€…å’Œè§‚å¯Ÿè€…å¾ˆåƒï¼Œä½†æ˜¯ï¼Œä¸­ä»‹è€…ä¸»è¦åŠŸèƒ½æ˜¯æ¶ˆé™¤ä¸€ç³»åˆ—çš„ç»„ä»¶ä¹‹é—´çš„ä¾èµ–ï¼Œç”¨äºç®¡ç†ç»„ä»¶ä¹‹é—´çš„è°ƒç”¨ï¼Œè€Œè§‚å¯Ÿè€…å¼ºè°ƒçš„æ˜¯å‘å¸ƒè€…å‘å„ä¸ªè®¢é˜…çš„è®¢é˜…è€…åˆ†å‘ä¿¡æ¯ã€‚</p></li><li><p>çŠ¶æ€æ¨¡å¼ï¼ˆçŠ¶æ€æ¨¡å¼ï¼‰ä¸ç­–ç•¥æ¨¡å¼ï¼ˆstrategyï¼‰å…³é”®åŒºåˆ«ï¼š</p><p>çŠ¶æ€æ¨¡å¼ä¸­çš„ç‰¹å®šçŠ¶æ€çŸ¥é“å…¶å®ƒçŠ¶æ€çš„å­˜åœ¨ï¼Œèƒ½ä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°å¦ä¸€çŠ¶æ€ã€‚</p><p>ç­–ç•¥æ¨¡å¼ä¸­æŸä¸ªç­–ç•¥ä¸çŸ¥é“å…¶å®ƒç­–ç•¥çš„å­˜åœ¨ã€‚</p></li><li><p>æ¨¡ç‰ˆæ–¹æ³•ï¼ˆtemplate method) ä¸­ï¼Œè¶…ç±»å®šä¹‰äº†è‹¥å¹²æ¨¡æ¿æ¡†æ¶æ–¹æ³•ï¼ˆå›ºå®šçš„ï¼‰å’Œæ­¥éª¤æ–¹æ³•ï¼Œå­ç±»ä¸èƒ½ä¿®æ”¹æ¡†æ¶æ–¹æ³•ï¼Œåªèƒ½é‡å†™æ­¥éª¤æ–¹æ³•ã€‚æ¨¡æ¿æ–¹æ³•ä¸­å¯ä»¥è°ƒç”¨è¯¦ç»†çš„æ­¥éª¤æ–¹æ³•ã€‚å·¥å‚æ¨¡å¼æ˜¯æ¨¡ç‰ˆæ–¹æ³•çš„ç‰¹æ®Šå½¢å¼ã€‚</p></li><li><p>è®¿é—®è€…ï¼ˆvisitor) å°†æ“ä½œäº¤ç»™å…¶å®ƒçš„ç±»ï¼ˆè®¿é—®è€…ç±»ï¼‰ï¼Œå…è®¸è®¿é—®è€…è¿›è¡Œè®¿é—®ã€‚å®ƒæ˜¯å‘½ä»¤æ¨¡å¼çš„åŠ å¼ºç‰ˆæœ¬ã€‚è®¿é—®è€…æ¨¡å¼ä¸­ï¼Œä¸šåŠ¡åœ¨éœ€è¦ä½¿ç”¨è®¿é—®æœåŠ¡çš„æ—¶å€™ï¼Œä¼ é€’è‡ªå·±çš„å¼•ç”¨ç»™è®¿é—®è€…ï¼Œè€Œä»£ç†æ¨¡å¼å’Œå§”æ‰˜æ¨¡å¼æ˜¯å°†è‡ªèº«å¼•ç”¨æ³¨å…¥åˆ°å—æ‰˜ä»˜åˆ°å¯¹è±¡ä¸­ï¼Œç§»äº¤è‡ªå·±çš„æƒåˆ©ã€‚</p></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://wowios.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/>è®¾è®¡æ¨¡å¼</a></li></ul><nav class=paginav><a class=prev href=https://wowios.com/post/language/java/java/><span class=title>Â« Prev</span><br><span>Java</span>
</a><a class=next href=https://wowios.com/post/language/swift/28advanced-operators/><span class=title>Next Â»</span><br><span>Advanced Operators</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share å„ç§è®¾è®¡æ¨¡å¼ on x" href="https://x.com/intent/tweet/?text=%e5%90%84%e7%a7%8d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f&amp;url=https%3a%2f%2fwowios.com%2fpost%2fdesign-pattern%2fall-design-pattern%2f&amp;hashtags=%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share å„ç§è®¾è®¡æ¨¡å¼ on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwowios.com%2fpost%2fdesign-pattern%2fall-design-pattern%2f&title=%e5%90%84%e7%a7%8d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share å„ç§è®¾è®¡æ¨¡å¼ on telegram" href="https://telegram.me/share/url?text=%e5%90%84%e7%a7%8d%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f&amp;url=https%3a%2f%2fwowios.com%2fpost%2fdesign-pattern%2fall-design-pattern%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://wowios.com/>CodePaper</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>